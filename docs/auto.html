---

title: Examples


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/auto.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/auto.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Base-class">Base class<a class="anchor-link" href="#Base-class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AutoBaseModel" class="doc_header"><code>class</code> <code>AutoBaseModel</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AutoBaseModel</code>(<strong><code>horizon</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoNHITS">AutoNHITS<a class="anchor-link" href="#AutoNHITS"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NHITS" class="doc_header"><code>class</code> <code>NHITS</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L57" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NHITS</code>(<strong><code>horizon</code></strong>, <strong><code>space</code></strong>=<em><code>None</code></em>) :: <a href="/neuralforecast/auto.html#AutoBaseModel"><code>AutoBaseModel</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nhits_space" class="doc_header"><code>nhits_space</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nhits_space</code>(<strong><code>horizon</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Suggested hyperparameters search space for tuning. To be used with hyperopt library.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>horizon: int
    Forecasting horizon.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>space: Dict
    Dictionary with search space for hyperopt library.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoNBEATS">AutoNBEATS<a class="anchor-link" href="#AutoNBEATS"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBEATS" class="doc_header"><code>class</code> <code>NBEATS</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L126" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBEATS</code>(<strong><code>horizon</code></strong>, <strong><code>space</code></strong>=<em><code>None</code></em>) :: <a href="/neuralforecast/auto.html#AutoBaseModel"><code>AutoBaseModel</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nbeats_space" class="doc_header"><code>nbeats_space</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nbeats_space</code>(<strong><code>horizon</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Suggested hyperparameters search space for tuning. To be used with hyperopt library.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>horizon: int
    Forecasting horizon.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>space: Dict
    Dictionary with search space for hyperopt library.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoRNN">AutoRNN<a class="anchor-link" href="#AutoRNN"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RNN" class="doc_header"><code>class</code> <code>RNN</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L188" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RNN</code>(<strong><code>horizon</code></strong>, <strong><code>space</code></strong>=<em><code>None</code></em>) :: <a href="/neuralforecast/auto.html#AutoBaseModel"><code>AutoBaseModel</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rnn_space" class="doc_header"><code>rnn_space</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rnn_space</code>(<strong><code>horizon</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Suggested hyperparameters search space for tuning. To be used with hyperopt library.
This space is not complete for training, will be completed automatically within
the fit method of the AutoBaseModels.</p>

<pre><code>Parameters
----------
horizon: int
    Forecasting horizon

Returns
----------
space: Dict
    Dictionary with search space for hyperopt library.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AutoNF">AutoNF<a class="anchor-link" href="#AutoNF"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AutoNF" class="doc_header"><code>class</code> <code>AutoNF</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/auto.py#L256" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AutoNF</code>(<strong><code>models</code></strong>, <strong><code>horizon</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The forecasting task we selected is to predict the number of patients with influenza-like illnesses from the <a href="https://gis.cdc.gov/grasp/fluview/fluportaldashboard.html">US CDC dataset</a>, the dataset contains 7 target variables, and has 966 weeks of history.</p>
<p>We will be creating point forecasts with N-BEATS, N-HiTS and RNN models. The predictive features will be the autoregressive features. More information on the dataset can be found in the <a href="https://arxiv.org/abs/2201.12886">N-HiTS paper</a>.</p>
<p>Table of Contents</p>
<ol>
<li><a href="#cell-1">Installing NeuralForecast Library</a></li>
<li><a href="#cell-2">Data Loading and Processing</a></li>
<li><a href="#cell-3">Define Hyperparameter Space</a></li>
<li><a href="#cell-4">Hyperparameter Tuning</a></li>
<li><a href="#cell-5">Evaluate Results</a></li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name="cell-1"></a></p>
<h3 id="1.-Installing-Neuralforecast-library">1. Installing Neuralforecast library<a class="anchor-link" href="#1.-Installing-Neuralforecast-library"> </a></h3><p>You can install the released version of NeuralForecast from the Python package index with:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#!pip install neuralforecast</span>
<span class="c1">#!pip install matplotlib</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">neuralforecast</span> <span class="k">as</span> <span class="nn">nf</span>
<span class="kn">from</span> <span class="nn">neuralforecast.data.datasets.long_horizon</span> <span class="kn">import</span> <span class="n">LongHorizon</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name="cell-2"></a></p>
<h3 id="2.-Data-Loading-and-Processing">2. Data Loading and Processing<a class="anchor-link" href="#2.-Data-Loading-and-Processing"> </a></h3><p>For this example we keep 10% of the observations as validation and use the latest 20% of the observations as the test set. To do so we use the sample_mask and declare the windows that will be used to train, and validate the model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y_df</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">LongHorizon</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;ILI&#39;</span><span class="p">)</span>
<span class="n">Y_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_series</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">n_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1"># dataset is balanced</span>

<span class="n">n_ts_test</span> <span class="o">=</span> <span class="mi">193</span>
<span class="n">n_ts_val</span> <span class="o">=</span> <span class="mi">97</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n_time&#39;</span><span class="p">,</span> <span class="n">n_time</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n_series&#39;</span><span class="p">,</span> <span class="n">n_series</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n_ts_test&#39;</span><span class="p">,</span> <span class="n">n_ts_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n_ts_val&#39;</span><span class="p">,</span> <span class="n">n_ts_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#                &#39;AGE 5-24&#39;, &#39;ILITOTAL&#39;, &#39;NUM. OF PROVIDERS&#39;, &#39;OT&#39;]</span>
<span class="n">y_plot</span> <span class="o">=</span> <span class="n">Y_df</span><span class="p">[</span><span class="n">Y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">==</span><span class="s1">&#39;% WEIGHTED ILI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span>
<span class="n">x_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="n">Y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">==</span><span class="s1">&#39;% WEIGHTED ILI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x_plot</span><span class="p">[</span><span class="n">n_time</span><span class="o">-</span><span class="n">n_ts_val</span><span class="o">-</span><span class="n">n_ts_test</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x_plot</span><span class="p">[</span><span class="n">n_time</span><span class="o">-</span><span class="n">n_ts_test</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weighted ILI [ratio]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.0-auto.NHITS">3.0 auto.NHITS<a class="anchor-link" href="#3.0-auto.NHITS"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_nhits</span> <span class="o">=</span> <span class="n">NHITS</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">auto_nhits</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Override max_steps for faster example</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_nhits</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">n_ts_val</span><span class="o">=</span><span class="n">n_ts_val</span><span class="p">,</span>
               <span class="n">n_ts_test</span><span class="o">=</span><span class="n">n_ts_test</span><span class="p">,</span>
               <span class="n">results_dir</span><span class="o">=</span><span class="s1">&#39;./results/autonhits&#39;</span><span class="p">,</span>
               <span class="n">save_trials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">loss_function_val</span><span class="o">=</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
               <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
                                    <span class="s1">&#39;mse&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mse</span><span class="p">},</span>
               <span class="n">return_test_forecast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecasts</span> <span class="o">=</span> <span class="n">auto_nhits</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">)</span>
<span class="n">forecasts</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1-auto.NBEATS">3.1 auto.NBEATS<a class="anchor-link" href="#3.1-auto.NBEATS"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_nbeats</span> <span class="o">=</span> <span class="n">NBEATS</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">auto_nbeats</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Override max_steps for faster example</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_nbeats</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">n_ts_val</span><span class="o">=</span><span class="n">n_ts_val</span><span class="p">,</span>
                <span class="n">n_ts_test</span><span class="o">=</span><span class="n">n_ts_test</span><span class="p">,</span>
                <span class="n">results_dir</span><span class="o">=</span><span class="s1">&#39;./results/autonbeats&#39;</span><span class="p">,</span>
                <span class="n">save_trials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">loss_function_val</span><span class="o">=</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
                <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
                                     <span class="s1">&#39;mse&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mse</span><span class="p">},</span>
                <span class="n">return_test_forecast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecasts</span> <span class="o">=</span> <span class="n">auto_nbeats</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">)</span>
<span class="n">forecasts</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1-auto.RNN">3.1 auto.RNN<a class="anchor-link" href="#3.1-auto.RNN"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_rnn</span> <span class="o">=</span> <span class="n">RNN</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">auto_rnn</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Override max_steps for faster example</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">auto_rnn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">n_ts_val</span><span class="o">=</span><span class="n">n_ts_val</span><span class="p">,</span>
             <span class="n">n_ts_test</span><span class="o">=</span><span class="n">n_ts_test</span><span class="p">,</span>
             <span class="n">results_dir</span><span class="o">=</span><span class="s1">&#39;./results/autornn&#39;</span><span class="p">,</span>
             <span class="n">save_trials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">loss_function_val</span><span class="o">=</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
             <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
                                  <span class="s1">&#39;mse&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mse</span><span class="p">},</span>
             <span class="n">return_test_forecast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecasts</span> <span class="o">=</span> <span class="n">auto_rnn</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">)</span>
<span class="n">forecasts</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-AutoNF">4. AutoNF<a class="anchor-link" href="#4.-AutoNF"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name="cell-3"></a></p>
<h3 id="Define-Hyperparameter-Space">Define Hyperparameter Space<a class="anchor-link" href="#Define-Hyperparameter-Space"> </a></h3><p>A temporal train-evaluation split procedure allows us to estimate the model’s generalization performance on future data unseen by the model. We use the train set to optimize the model parameters, and the validation  and test sets to evaluate the accuracy of the model’s predictions.</p>
<p>In this case we set the space to <code>None</code>, that implicitly uses the predefined model space, but the space can be specified as a dictionary following the conventions of the <a href="https://github.com/hyperopt/hyperopt">Hyperopt package</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecast_horizon</span> <span class="o">=</span> <span class="mi">24</span>

<span class="n">nhits_space_dict</span> <span class="o">=</span> <span class="n">nhits_space</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">)</span>
<span class="n">nhits_space_dict</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="n">nhits_space_dict</span><span class="p">[</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">nbeats_space_dict</span> <span class="o">=</span> <span class="n">nbeats_space</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">)</span>
<span class="n">nbeats_space_dict</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="n">nbeats_space_dict</span><span class="p">[</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">rnn_space_dict</span> <span class="o">=</span> <span class="n">rnn_space</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">)</span>
<span class="n">rnn_space_dict</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="n">rnn_space_dict</span><span class="p">[</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_epochs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nbeats&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nhits_space_dict</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="c1"># Use space=None for default dict</span>
               <span class="s1">&#39;nhits&#39;</span><span class="p">:</span>  <span class="nb">dict</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space_dict</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="c1"># Use space=None for default dict</span>
               <span class="s1">&#39;rnn&#39;</span><span class="p">:</span>    <span class="nb">dict</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">rnn_space_dict</span><span class="p">,</span> <span class="n">hyperopt_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Use space=None for default dict</span>
              <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name="cell-4"></a></p>
<h3 id="Hyperparameter-Tuning">Hyperparameter Tuning<a class="anchor-link" href="#Hyperparameter-Tuning"> </a></h3><p>A temporal train-validation-test (676,97,193) split procedure allows us to estimate the model’s generalization performance on future data unseen by the model. We use the train set to optimize the model parameters, and the validation  and test sets to evaluate the accuracy of the model’s predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecast_horizon</span> <span class="o">=</span> <span class="mi">24</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">AutoNF</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">loss_function_val</span><span class="o">=</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span> 
          <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mae</span><span class="p">,</span>
                               <span class="s1">&#39;mse&#39;</span><span class="p">:</span><span class="n">nf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">mse</span><span class="p">},</span>
          <span class="n">n_ts_val</span><span class="o">=</span><span class="n">n_ts_val</span><span class="p">,</span>
          <span class="n">n_ts_test</span><span class="o">=</span><span class="n">n_ts_test</span><span class="p">,</span>
          <span class="n">results_dir</span><span class="o">=</span><span class="s1">&#39;./results/auto&#39;</span><span class="p">,</span>
          <span class="n">return_forecasts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Val-losses">Val losses<a class="anchor-link" href="#Val-losses"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MAE&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NHITS:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nhits&#39;</span><span class="p">][</span><span class="s1">&#39;best_val_loss&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NBEATS:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;best_val_loss&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RNN:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;rnn&#39;</span><span class="p">][</span><span class="s1">&#39;best_val_loss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Val-losses-trajectory">Val losses trajectory<a class="anchor-link" href="#Val-losses-trajectory"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">time</span>   <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;optimization_times&#39;</span><span class="p">]</span>
<span class="n">losses</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;optimization_losses&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">losses</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;segs&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;val loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a name="cell-5"></a></p>
<h3 id="5.-Evaluate-Results">5. Evaluate Results<a class="anchor-link" href="#5.-Evaluate-Results"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we wrangle the numpy predictions to evaluate and plot the predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span><span class="p">((</span><span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;y_true&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;rnn&#39;</span><span class="p">][</span><span class="s1">&#39;y_true&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat_nhits</span>  <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nhits&#39;</span><span class="p">][</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span>
<span class="n">y_hat_nbeats</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span>
<span class="n">y_hat_rnn</span>    <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;rnn&#39;</span><span class="p">][</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span>
<span class="n">y_true</span>       <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;nbeats&#39;</span><span class="p">][</span><span class="s1">&#39;y_true&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Shapes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. y_hat_nhits.shape (N,T,H) </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y_hat_nhits</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. y_hat_nbeats.shape (N,T,H)</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y_hat_nbeats</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. y_hat_rnn.shape (N,T,H)</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y_hat_rnn</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. y_true.shape (N,T,H)</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">u_idx</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">u_idx</span><span class="p">,</span><span class="n">w_idx</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_hat_nbeats</span><span class="p">[</span><span class="n">u_idx</span><span class="p">,</span><span class="n">w_idx</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N-BEATS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_hat_nhits</span><span class="p">[</span><span class="n">u_idx</span><span class="p">,</span><span class="n">w_idx</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N-HiTS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_hat_rnn</span><span class="p">[</span><span class="n">u_idx</span><span class="p">,</span><span class="n">w_idx</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RNN&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weighted ILI [ratio]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">best_model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Passing-only-models-name">Passing only models name<a class="anchor-link" href="#Passing-only-models-name"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forecast_horizon</span> <span class="o">=</span> <span class="mi">24</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">AutoNF</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nhits&#39;</span><span class="p">,</span> <span class="s1">&#39;rnn&#39;</span><span class="p">,</span> <span class="s1">&#39;nbeats&#39;</span><span class="p">],</span> <span class="n">horizon</span><span class="o">=</span><span class="n">forecast_horizon</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

