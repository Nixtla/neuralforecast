---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "Set of functions to easily perform experiments."
description: "Set of functions to easily perform experiments."
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>ds_in_test</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>n_ds_val_window</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>freq</code></strong>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ds_in_test: int
    Number of ds in test.
n_uids: int
    Number of unique ids in validation.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
periods: int
    ds_in_test multiplier.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>mask_df</code></strong>, <strong><code>normalizer_y</code></strong>, <strong><code>normalizer_x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L170" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>, <strong><code>train_dataset</code></strong>, <strong><code>val_dataset</code></strong>, <strong><code>test_dataset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L216" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L251" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L283" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L312" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L319" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L373" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>loss_kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L420" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>, <strong><code>hyperopt_max_evals</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>save_trials</code></strong>=<em><code>False</code></em>, <strong><code>loss_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">from</span> <span class="nn">nixtla.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">smape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">pinball_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>  

<span class="n">nbeats_space</span><span class="o">=</span> <span class="p">{</span><span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;shared_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;selu&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;initialization&#39;</span><span class="p">:</span>  <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;initialization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span><span class="s1">&#39;he_normal&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;stack_types&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_blocks&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_layers&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">364</span> <span class="p">]),</span>
               <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_harmonics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_polynomials&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;weight_decay&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-3</span><span class="p">)),</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span> <span class="c1">#[args.max_epochs]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_val_weeks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss_hypar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]),</span>                
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span> <span class="c1">#[args.val_loss]),</span>
               <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;l1_theta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>                
               <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>      
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">device</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span>
      <span class="s1">&#39;initialization&#39;</span><span class="p">:</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
      <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
      <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span>
      <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1">#0.002,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
      <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00015</span><span class="p">,</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;PINBALL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="c1">#0.49,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">100_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_space</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;esrnn&#39;</span><span class="p">]),</span>
               <span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;dilations&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span> <span class="p">]),</span>
               <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;es_component&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LSTM&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;state_hsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;add_nl_layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">]),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
               <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
               <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-8</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]),</span>
               <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;noise_std&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;testing_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;training_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SMYL&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">500_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="kc">None</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;esrnn&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]],</span>
      <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span>
      <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="c1">#00,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
      <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> 
      <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;SMYL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">500_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">instantiate_esrnn</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nixtla.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span><span class="p">,</span> <span class="n">EPFInfo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>

<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
<span class="n">Y_min</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="c1">#Y_df.y = Y_df.y - Y_min + 20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> 
                        <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

model                                   esrnn
input_size_multiplier                       7
output_size                                24
dilations                       [[1, 2], [7]]
es_component                   multiplicative
cell_type                                LSTM
state_hsize                                50
add_nl_layer                            False
seasonality                              [24]
n_iterations                               10
early_stopping                             10
eval_freq                                  10
batch_size                                 32
learning_rate                          0.0005
lr_scheduler_step_size                    100
lr_decay                                  0.8
per_series_lr_multip                      1.5
gradient_eps                              0.0
gradient_clipping_threshold                20
rnn_weight_decay                          0.0
noise_std                              0.0005
level_variability_penalty                  10
testing_percentile                         50
training_percentile                        50
random_seed                                 1
loss                                     SMYL
val_loss                                  MAE
len_sample_chunks                         672
window_sampling_limit                  500000
complete_inputs                          True
idx_to_sample_freq                         24
val_idx_to_sample_freq                     24
n_series_per_batch                          1
normalizer_y                             None
normalizer_x                             None
dtype: object
===============================================

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All constructed windows will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

============================== Start fitting ==============================
Step: 10, Time: 1.902, Insample SMYL: 0.06189, Outsample MAE: 3.52928
Step: 10, Time: 2.031, Insample SMYL: 0.06189, Outsample MAE: 3.52928
==============================  End fitting  ==============================


y_true.shape (#n_series, #n_fcds, #lt): (727, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (727, 24)


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 3.5292816694889084,
 &#39;mc&#39;: {&#39;model&#39;: &#39;esrnn&#39;,
  &#39;input_size_multiplier&#39;: 7,
  &#39;output_size&#39;: 24,
  &#39;dilations&#39;: [[1, 2], [7]],
  &#39;es_component&#39;: &#39;multiplicative&#39;,
  &#39;cell_type&#39;: &#39;LSTM&#39;,
  &#39;state_hsize&#39;: 50,
  &#39;add_nl_layer&#39;: False,
  &#39;seasonality&#39;: [24],
  &#39;n_iterations&#39;: 10,
  &#39;early_stopping&#39;: 10,
  &#39;eval_freq&#39;: 10,
  &#39;batch_size&#39;: 32,
  &#39;learning_rate&#39;: 0.0005,
  &#39;lr_scheduler_step_size&#39;: 100,
  &#39;lr_decay&#39;: 0.8,
  &#39;per_series_lr_multip&#39;: 1.5,
  &#39;gradient_eps&#39;: 1e-08,
  &#39;gradient_clipping_threshold&#39;: 20,
  &#39;rnn_weight_decay&#39;: 0.0,
  &#39;noise_std&#39;: 0.0005,
  &#39;level_variability_penalty&#39;: 10,
  &#39;testing_percentile&#39;: 50,
  &#39;training_percentile&#39;: 50,
  &#39;random_seed&#39;: 1,
  &#39;loss&#39;: &#39;SMYL&#39;,
  &#39;val_loss&#39;: &#39;MAE&#39;,
  &#39;len_sample_chunks&#39;: 672,
  &#39;window_sampling_limit&#39;: 500000,
  &#39;complete_inputs&#39;: True,
  &#39;idx_to_sample_freq&#39;: 24,
  &#39;val_idx_to_sample_freq&#39;: 24,
  &#39;n_series_per_batch&#39;: 1,
  &#39;normalizer_y&#39;: None,
  &#39;normalizer_x&#39;: None},
 &#39;y_true&#39;: array([[26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
        [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
        [28.18, 27.03, 26.47, ..., 28.96, 27.77, 25.95],
        ...,
        [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
        [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
        [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]], dtype=float32),
 &#39;y_hat&#39;: array([[24.176363, 23.526276, 21.318415, ..., 29.180883, 27.245728,
         24.659803],
        [27.096184, 27.567818, 24.54904 , ..., 32.39544 , 30.086735,
         28.386831],
        [27.053219, 26.84327 , 24.110294, ..., 31.920671, 29.762712,
         27.46786 ],
        ...,
        [47.903812, 50.49012 , 48.90383 , ..., 52.55266 , 49.20979 ,
         46.794575],
        [49.41653 , 52.037704, 48.101646, ..., 53.39938 , 52.587395,
         49.23722 ],
        [50.349876, 53.55123 , 51.831455, ..., 55.882156, 52.942715,
         49.099586]], dtype=float32),
 &#39;trajectories&#39;: {&#39;iteration&#39;: [10],
  &#39;train_loss&#39;: [0.061885181814432144],
  &#39;val_loss&#39;: [3.5292816]},
 &#39;run_time&#39;: 4.225686311721802,
 &#39;status&#39;: &#39;ok&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7feaf0f96f10&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.013052 seconds
INFO:hyperopt.tpe:TPE using 0 trials
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

activation                                selu
batch_normalization                      False
batch_size                                 256
complete_inputs                          False
complete_sample                          False
device                                     cpu
dropout_prob_exogenous                0.105816
dropout_prob_theta                    0.416506
early_stopping                              16
eval_freq                                   50
exogenous_n_channels                       7.0
frequency                                    H
idx_to_sample_freq                          24
initialization                       he_normal
input_size_multiplier                        7
l1_theta                                     0
learning_rate                          0.00094
len_sample_chunks                         None
loss                                       MAE
loss_hypar                                 0.5
lr_decay                              0.399576
model                                   nbeats
n_blocks                                (1, 1)
n_harmonics                                  1
n_hidden                                   364
n_iterations                                10
n_layers                                (2, 2)
n_lr_decay_steps                             3
n_polynomials                                2
n_series_per_batch                           1
n_val_weeks                                104
normalizer_x                            median
normalizer_y                              None
output_size                                 24
random_seed                               11.0
seasonality                                 24
shared_weights                           False
stack_types               (identity, identity)
val_idx_to_sample_freq                      24
val_loss                                   MAE
weight_decay                          0.000187
window_sampling_limit                   100000
x_s_n_hidden                                 0
dtype: object
===============================================

  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All constructed windows will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.289, Insample MAE: 2.58115, Outsample MAE: 2.77182
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 727, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (1, 727, 24)
 50%|     | 1/2 [00:02&lt;00:02,  2.18s/trial, best loss: 2.771820306777954]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.022478 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 2.771820
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

activation                                     selu
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                          cpu
dropout_prob_exogenous                     0.176561
dropout_prob_theta                          0.22673
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                            3.0
frequency                                         H
idx_to_sample_freq                               24
initialization                        glorot_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000729
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.325577
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    15.0
seasonality                                      24
shared_weights                                False
stack_types               (exogenous_tcn, identity)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                               0.002945
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================

 50%|     | 1/2 [00:02&lt;00:02,  2.18s/trial, best loss: 2.771820306777954]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All constructed windows will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.991, Insample MAE: 3.80512, Outsample MAE: 4.59031
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 727, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (1, 727, 24)
100%|| 2/2 [00:05&lt;00:00,  2.57s/trial, best loss: 2.771820306777954]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">trials</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;state&#39;: 2,
  &#39;tid&#39;: 0,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 2.771820306777954,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.10581553046033915,
    &#39;dropout_prob_theta&#39;: 0.4165056103773009,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 7.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;he_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.000939779995658843,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.3995763692240326,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 11.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.0001872003712446687,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           [28.18, 27.03, 26.47, ..., 28.96, 27.77, 25.95],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[24.21314 , 24.508463, 24.523079, ..., 27.569704, 27.468277,
            25.61391 ],
           [28.022871, 28.170614, 27.993181, ..., 31.055342, 30.923   ,
            28.618698],
           [27.66243 , 27.765148, 27.138403, ..., 30.251446, 30.143866,
            28.067032],
           ...,
           [47.09138 , 47.16198 , 46.82284 , ..., 51.333225, 50.422676,
            48.45039 ],
           [48.99495 , 48.037834, 48.13943 , ..., 52.98363 , 52.42395 ,
            50.038666],
           [50.826683, 50.17292 , 50.361393, ..., 55.01001 , 54.753426,
            51.009407]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.1302835941314697,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 0,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.10581553046033915],
    &#39;dropout_prob_theta&#39;: [0.4165056103773009],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [7.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.000939779995658843],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.3995763692240326],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [11.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.0001872003712446687],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 3, 23, 58, 16, 131000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 3, 23, 58, 18, 290000)},
 {&#39;state&#39;: 2,
  &#39;tid&#39;: 1,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 4.590313911437988,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.17656062062305888,
    &#39;dropout_prob_theta&#39;: 0.22672979338206267,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 3.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0007290139029619916,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.3255767716771787,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 15.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;exogenous_tcn&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.00294533544842303,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           [28.18, 27.03, 26.47, ..., 28.96, 27.77, 25.95],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[29.257915, 27.89654 , 27.049818, ..., 30.887268, 31.034042,
            28.517254],
           [32.244633, 31.210594, 30.21341 , ..., 33.792603, 34.349213,
            31.214745],
           [31.046055, 29.973436, 29.071932, ..., 32.37693 , 33.17161 ,
            29.833445],
           ...,
           [53.224983, 49.483948, 48.883453, ..., 57.37152 , 57.17512 ,
            51.858017],
           [55.3404  , 52.622734, 51.434315, ..., 59.851154, 60.972477,
            55.55228 ],
           [58.45892 , 55.098103, 54.37889 , ..., 62.89723 , 63.46253 ,
            57.448605]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.8894762992858887,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 1,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [1],
    &#39;batch_normalization&#39;: [1],
    &#39;batch_size&#39;: [1],
    &#39;complete_inputs&#39;: [1],
    &#39;complete_sample&#39;: [1],
    &#39;device&#39;: [1],
    &#39;dropout_prob_exogenous&#39;: [1],
    &#39;dropout_prob_theta&#39;: [1],
    &#39;early_stopping&#39;: [1],
    &#39;eval_freq&#39;: [1],
    &#39;exogenous_n_channels&#39;: [1],
    &#39;frequency&#39;: [1],
    &#39;idx_to_sample_freq&#39;: [1],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [1],
    &#39;l1_theta&#39;: [1],
    &#39;learning_rate&#39;: [1],
    &#39;len_sample_chunks&#39;: [1],
    &#39;loss&#39;: [1],
    &#39;loss_hypar&#39;: [1],
    &#39;lr_decay&#39;: [1],
    &#39;n_blocks&#39;: [1],
    &#39;n_harmonics&#39;: [1],
    &#39;n_hidden&#39;: [1],
    &#39;n_iterations&#39;: [1],
    &#39;n_layers&#39;: [1],
    &#39;n_lr_decay_steps&#39;: [1],
    &#39;n_polynomials&#39;: [1],
    &#39;n_series_per_batch&#39;: [1],
    &#39;n_val_weeks&#39;: [1],
    &#39;normalizer_x&#39;: [1],
    &#39;normalizer_y&#39;: [1],
    &#39;output_size&#39;: [1],
    &#39;random_seed&#39;: [1],
    &#39;seasonality&#39;: [1],
    &#39;shared_weights&#39;: [1],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [1],
    &#39;val_loss&#39;: [1],
    &#39;weight_decay&#39;: [1],
    &#39;window_sampling_limit&#39;: [1],
    &#39;x_s_n_hidden&#39;: [1]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.17656062062305888],
    &#39;dropout_prob_theta&#39;: [0.22672979338206267],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [3.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0007290139029619916],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.3255767716771787],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [15.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [2],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.00294533544842303],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 3, 23, 58, 18, 327000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 3, 23, 58, 21, 256000)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

