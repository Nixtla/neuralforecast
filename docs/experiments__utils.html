---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "Set of functions to easily perform experiments."
description: "Set of functions to easily perform experiments."
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>ds_in_test</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>n_ds_val_window</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>freq</code></strong>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ds_in_test: int
    Number of ds in test.
n_uids: int
    Number of unique ids in validation.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
periods: int
    ds_in_test multiplier.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>mask_df</code></strong>, <strong><code>normalizer_y</code></strong>, <strong><code>normalizer_x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L170" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>, <strong><code>train_dataset</code></strong>, <strong><code>val_dataset</code></strong>, <strong><code>test_dataset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L254" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L286" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L315" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L322" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L376" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>loss_kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L423" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>, <strong><code>hyperopt_max_evals</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>save_trials</code></strong>=<em><code>False</code></em>, <strong><code>loss_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">from</span> <span class="nn">nixtla.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">smape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">pinball_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>  

<span class="n">nbeats_space</span><span class="o">=</span> <span class="p">{</span><span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;shared_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;selu&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;initialization&#39;</span><span class="p">:</span>  <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;initialization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span><span class="s1">&#39;he_normal&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;stack_types&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_blocks&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_layers&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">364</span> <span class="p">]),</span>
               <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_harmonics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_polynomials&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;weight_decay&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-3</span><span class="p">)),</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span> <span class="c1">#[args.max_epochs]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_val_weeks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss_hypar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]),</span>                
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span> <span class="c1">#[args.val_loss]),</span>
               <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;l1_theta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>                
               <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>      
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">device</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span>
      <span class="s1">&#39;initialization&#39;</span><span class="p">:</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
      <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
      <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span>
      <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1">#0.002,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
      <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00015</span><span class="p">,</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;PINBALL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="c1">#0.49,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">100_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_space</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;esrnn&#39;</span><span class="p">]),</span>
               <span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;dilations&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span> <span class="p">]),</span>
               <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;es_component&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LSTM&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;state_hsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;add_nl_layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">]),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
               <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
               <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-8</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]),</span>
               <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;noise_std&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;testing_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;training_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SMYL&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">500_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="kc">None</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;esrnn&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]],</span>
      <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span>
      <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="c1">#00,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
      <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> 
      <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;SMYL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">500_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">instantiate_esrnn</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nixtla.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span><span class="p">,</span> <span class="n">EPFInfo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>

<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
<span class="n">Y_min</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="c1">#Y_df.y = Y_df.y - Y_min + 20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAAD4CAYAAAAXUaZHAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAyhElEQVR4nO3deXwUVbYH8N9J2HeQsIMBRZEdDMiqIAgIKq4j6CDjhj51BmWWB66MikYdl3FBHwpuI6gziiAw7CqbgGHfl0CAQAhhDTskOe+Prk6qK1XdVV1VvVSf7+cD6a6u6r7VSZ26devec4mZIYQQwluSol0AIYQQzpPgLoQQHiTBXQghPEiCuxBCeJAEdyGE8KAy0S4AANSuXZtTU1OjXQwhhIgrq1atOszMKXqvxURwT01NRUZGRrSLIYQQcYWI9hi9Js0yQgjhQRLchRDCgyS4CyGEB0lwF0IID5LgLoQQHhQyuBNRYyL6iYi2ENEmIhqpLK9FRPOIaIfys6ZqmzFEtJOIthFRfzd3QAghRGlmau4FAP7MzFcB6ALgcSJqCWA0gAXM3BzAAuU5lNeGAGgFYACA8USU7EbhhRBC6AsZ3Jk5h5lXK49PAtgCoCGAwQA+V1b7HMCtyuPBAL5m5vPMvBvATgCdHS63EBG3dt9xbNx/ItrFEMIUS23uRJQKoAOAFQDqMnMO4DsBAKijrNYQwD7VZtnKMu17jSCiDCLKyMvLC6PoQkTWrR8sxU3vLYl2MYQwxXRwJ6IqAL4D8CQz5wdbVWdZqRlBmHkCM6cxc1pKiu7oWSGECMuynYcxbOIKFBYl7mREptIPEFFZ+AL7V8z8vbI4l4jqM3MOEdUHcEhZng2gsWrzRgAOOFVgIYQI5bHJq3H8zEXkn72ImpXLRbs4UWGmtwwBmAhgCzO/pXppOoDhyuPhAKaplg8hovJE1BRAcwArnSuyEEKIUMzU3LsDGAZgAxGtVZY9DSAdwLdE9CCAvQDuAgBm3kRE3wLYDF9Pm8eZudDpggshhDAWMrgz8xLot6MDQB+DbcYBGGejXEIIIWyQEapCCOFBEtyFEMKDJLgLIYQHSXAXQnhW4vZyl+AuhPAgox4giUSCuxBCeJAEdyGE8CAJ7kII4UES3IUQwoMkuAshhAdJcBdCeBZz4naGlOAuhPAcXzLbxCbBXQghPEiCuxBCeJAEdyGE8CAJ7kII4UFmptmbRESHiGijatk3RLRW+Zfln6GJiFKJ6KzqtY9cLLsQQggDZqbZ+wzA+wC+8C9g5rv9j4noTQAnVOtnMnN7h8onhBBhS9yOkOam2VtERKl6rymTZ/8OwPUOl0sIIcImHSHtt7n3BJDLzDtUy5oS0Roi+oWIehptSEQjiCiDiDLy8vJsFkMIIYSa3eA+FMAU1fMcAE2YuQOAUQAmE1E1vQ2ZeQIzpzFzWkpKis1iCCGEUAs7uBNRGQC3A/jGv4yZzzPzEeXxKgCZAK6wW0ghhBDW2Km59wWwlZmz/QuIKIWIkpXHzQA0B7DLXhGFEEJYZaYr5BQAvwK4koiyiehB5aUhCGySAYBrAawnonUA/gPgUWY+6mSBhRBChGamt8xQg+V/0Fn2HYDv7BdLCCHsS+CkkDJCVQjhPZIUUoK7EEJ4kgR3IYTwIAnuQgjhQRLchRDCgyS4CyGEB0lwF0J4FidwXkgJ7kIID5K+kBLchRDCgyS4CyE8KHGbY/wkuAshPIsSuHlGgrsQQniQBHchhPAgCe5CCOFBEtyFEJ4l/dyFEMJTEvdGqp+ZmZgmEdEhItqoWjaWiPYT0Vrl30DVa2OIaCcRbSOi/m4VXIhI4kSe9UHEJTM1988ADNBZ/jYzt1f+zQIAImoJ3/R7rZRtxvvnVBVCCBE5IYM7My8CYHYe1MEAvmbm88y8G8BOAJ1tlE8IIUQY7LS5P0FE65Vmm5rKsoYA9qnWyVaWlUJEI4gog4gy8vLybBRDCCGEVrjB/UMAlwFoDyAHwJvKcr27GLqNlcw8gZnTmDktJSUlzGIIIYTQE1ZwZ+ZcZi5k5iIAH6Ok6SUbQGPVqo0AHLBXRCGECFMC3wcPK7gTUX3V09sA+HvSTAcwhIjKE1FTAM0BrLRXRCGEsIakJyTKhFqBiKYA6AWgNhFlA3gBQC8iag/feTELwCMAwMybiOhbAJsBFAB4nJkLXSm5EBEkPSFFvAkZ3Jl5qM7iiUHWHwdgnJ1CCSGEsEdGqAohhAdJcBdCCA+S4C6EEB4kwV0I4VmJfB9cgrsQwnOkJ6QEdyFMSeQaoIhPEtyFEMKDJLgLIYQHSXAXQggPkuAuhBAeJMFdCOFZiZwTSIK7EMJzJCukBHchTJEJskW8keAuhBAeJMFdCCE8SIK7ECLm7Tx0KtpFiDshgzsRTSKiQ0S0UbXsDSLaSkTriWgqEdVQlqcS0VkiWqv8+8jFsgshEsDCrbno+9YvmLZ2f7SLElfM1Nw/AzBAs2wegNbM3BbAdgBjVK9lMnN75d+jzhRTCJGoth301do35+Rb3pYTOCtQyODOzIsAHNUsm8vMBcrT5QAauVA2IYQIC0leSEfa3B8A8F/V86ZEtIaIfiGinkYbEdEIIsogooy8vDwHiiGEEMLPVnAnomcAFAD4SlmUA6AJM3cAMArAZCKqprctM09g5jRmTktJSbFTDCFcl7gX9yJehR3ciWg4gJsA3MvKCA9mPs/MR5THqwBkArjCiYIKIRJTIreb2xFWcCeiAQD+F8AtzHxGtTyFiJKVx80ANAewy4mCCiESm7SjW1Mm1ApENAVALwC1iSgbwAvw9Y4pD2Ae+ZI4LFd6xlwL4EUiKgBQCOBRZj6q+8ZCCOESqe2bCO7MPFRn8USDdb8D8J3dQgkhhBMSubYvI1SFEJ6VyDV4Ce5CCM9J5Bq7nwR3IUyQjL8i3khwF0IID5LgLoQQHiTBXQghPEiCuxBCeJAEdyFETLNzMzuRb4QnXHDfe+QM/rV8T7SLIYSwiCz0brSyrleFHKHqNXdP+BU5J87h9o4NUalcwu2+CFMiD4YR8Snhau7Hz1yMdhGEEMJ1CRfc/RK5LU4I4X0JF9ylLU4IkQgSLrgLIUQiSNjgLq0yQnhfIh/nIYM7EU0iokNEtFG1rBYRzSOiHcrPmqrXxhDRTiLaRkT93Sp4uKRVRgjvk+PcXM39MwADNMtGA1jAzM0BLFCeg4haAhgCoJWyzXj/tHtCxDO5AS/iTcjgzsyLAGinyhsM4HPl8ecAblUt/1qZKHs3gJ0AOjtTVGexHK1CCA8Lt829LjPnAIDys46yvCGAfar1spVlMYOku4wQcUmOXGucvqGq9/3rVpGJaAQRZRBRRl5ensPFEEKIxBZucM8lovoAoPw8pCzPBtBYtV4jAAf03oCZJzBzGjOnpaSkhFmM8EmjjBDCy8IN7tMBDFceDwcwTbV8CBGVJ6KmAJoDWGmviM6SSzshEkci31sLmTmLiKYA6AWgNhFlA3gBQDqAb4noQQB7AdwFAMy8iYi+BbAZQAGAx5m50KWyW3KhoAj3TVqBk+cLol0UEYcuFBZFuwgJK5wALffWTAR3Zh5q8FIfg/XHARhnp1Bu2HX4FJbvKun0k8AndBGGnq/9FO0iCGFJwo5QFcKKE2clm2i0SC08PAkT3KWmLoRIJAkT3EuRYC+E8LCECe7amvvklXujUxAhhCWJ3OPFjoQJ7lqvzd4a7SIIISwIp+k9kc8LCRPcZQ5MIUQiSZjgLoQQicQzwf3QyXM4JQOUhBCQQWeAh4J753EL0PfNX6JdDCFEDMg7eR4AsHDroRBrepdngjsAHMw/p7ucmfHhz5kRLo0QItpOnkvcwWeeCu5GVu05hhnrc6JdDCFEhJ0vSNzmmYQI7tL+JkRiem/hzmgXoVj+uYv46JdMFBVFpuee54L7tLX7o10EIWJaQWERsg6fjnYxEs6LP25G+n+34qdtkbkP4LngPvLrtaWWkWRxF6LYK7O2otc/fkbOibPRLkpC8bf/Z+adisjneS6465GkckKUWJZ5GABw7HR83Gz02ijTV2ZFZnR8QgR3IUT8i/crcPVJ6lD+OWRkHTVe2QFhB3ciupKI1qr+5RPRk0Q0loj2q5YPdLLAYZU12gUQQrjm7z9uQq834msylQH/XIw7P/oVf5yyxrXPCDu4M/M2Zm7PzO0BXA3gDICpystv+19j5lkOlFMIIXR9ujQLWUfORLsYlhw9fQEA8OO6A659hlPNMn0AZDLzHofez1FHlC9SCFHCa8n09h8/iwPH5Saxn1PBfQiAKarnTxDReiKaREQ19TYgohFElEFEGXl5eQ4VQ9+kJbt1l/+y3d3PFSIWxdu0dWZPQd3TF6Jb+kJXy2JHpE+ltoM7EZUDcAuAfyuLPgRwGYD2AHIAvKm3HTNPYOY0Zk5LSUmxW4ywLJLgLjyEmfHyjM3YuP9EtIsiYoATNfcbAaxm5lwAYOZcZi5k5iIAHwPo7MBnBBUqG6TRGdNrXaxEYjt9oRCfLNmNu//v12gXxVHxdZ0RO5wI7kOhapIhovqq124DsNGBzwjqWIg2daNpuk5LimCRwKRyE1mR/r5tBXciqgTgBgDfqxa/TkQbiGg9gN4AnrLzGW76JmNftIsgYsiRU+dx7mJhtIthW6gYEm814QIlF0tu/jnkn7uI9dnHLW2ffewMxs3cHLGcLkYW7YhsM3AZOxsz8xkAl2iWDbNVIhdIBUWYcfXL83FN01r45pGu0S5KWMwG7Xg7HhYrQfHfq7KRmXcKq/cex+5XB5q+MfzHKWuwZu9x3NS2Ado1ruFiSYO7EOEMlQkxQjXKJ+yEU1BYhII4zcS5Yre7owbdZPXPPF46zaiP39V7j4deX3PAFyrP3QoDsdr90hPBPeQfqTQuRtTlz/wX18usWMIhesd3sEN6oqbrs3/zez5e7lyhFM3GzES39IWYvznX8fe2yxPBPRQJ7ZG392h8jRj0AqsV8Xis8/gDfbCij5u1RXejMxecv5/iv0h46IsMx9/brsQI7jH6R7w99yT+/uMmw948QrghTlpjAACHT53HGlVTTDhlP+hSamO3E3/Z5YngrndjJefE2ZgPmsMmrsCnS7MM534VItE9MXm17nIrx3Zu/vmA55NX7MXBE/aPuTs/iu3xBJ4I7hs0XaM2HTiBrq8uxL+W+1LdxGoODf/fp14qUy90yRPR4UbzQ7QcPxOYc95u6oS8k+fx9NQN+MOnK229TzzwRHDP0ZyFd+X5phBbvst32RTjFfiAG0bnCwox6pu1aPHcbGzJyY9eoYSIAYUGXd3CPaT973c0AZIJeiK4a4N3yU2XGI/qOt6YvQ3fr/HNA7vpgHeCe9dXFyB19MxoF0OgdO+TxTvycDZGa/tFmoPb7v2CrQd9x1QkIsPJcxdx4z8XF3+mEbemO/REcNf2zPA3c/j/LmKx5n7uYiEOnTxfarl6X85e8E56BO3VlYgNOw+dxLCJK/HsD65nCQmL9thlzXKro1X/8Olvuu/rhqU7j2BLTj7enLs96HpDJjjfRRPwSHD/bFlWwPPimrvyC9wcg80bRjOwqGtVz03bFKHSiGAGf7A02kUwRVvLNePEWV8FIlKTNltVqNknbTPN6fPhXnG4H939N32TyNfWb8Stio8ngruWPz7O3nQwZmd4X7bzcPHjeOqalojW7Tse7SKYsmDLIcvbxPooVaMTlt0mVzdq7v6Jx/3856E5m3LRadz8IGVx50TjyeCudr9yGRZrjO76HznlrRs9szfmSFt7hNjpYRWDLZcAgCKDLBZ246HV2dmW7jyMNmPn4OS5i4br3PPxioDn2qsOIxcLJbibpo6bx87EZrA0qjBl7DkW0XK47dF/6fdTFs4zG0zUYrzijhNnjYMpELnj+95PVuDkuQK0GTvXdKrwaI+zsZUVMh5oBzDEjFg/qkTcyTleuu129d5jaN2gOsqVCVGPi8VeBwg+Ec+sDTl47Cv3Kw9tx84JeN7qhTkGa/pORqfOF6BhjYph3QNxkidr7v+3aJfpdaN9dhXCKes0PUd25J7E7eOX4RVtrhUVf2eDddnxNzXfil1HHH/PN+duwyNfluSJ+XTpbuSfM99r7asVe9A9fSFmrD+AaCdG9WTNfY2JtKB+zMDeo6dRxEDT2pXdK1QwUosXDth28GTA88PK/Ruj3mLM1o6VWMLszkTf7y3cWfx45e6j+PuPmy1t//rsbQCADftP4LKUKo6WzSq7MzFlKbMurSWiDGVZLSKaR0Q7lJ81nSmqO4qYcd0bP6P3P3525f0z807himf+i71HSvqv5508j5MWagNCmGE0b0GwEGglPObmn8MvMTSpfKjBQXYcOnkOq2zc/0oiinqrgBPNMr2ZuT0zpynPRwNYwMzNASxQnsesApdn8vh3RjYuFBbhx/UHipcF6xaltWpPbGee8wr1gVhUxOj/9iLMXJ8TxRJZV17Trm7UXdA/8vmsxd41t7y/BMMnxUZOFgYXpxdxQ+dxC/Da7K1hb09wrxeMWW60uQ8G8Lny+HMAt7rwGY45rzP11ZFT57FxvzNtkP4DLCnIJaRe4jC//6zab/jaW/O2x8zBFm8OnjiH/aoZdNTn+PMFRdiWexKjvl0b+YLZULFccvFjZsbyTF+btPpPT90t9bRmBPSCLcEnnIilzgmxfqts/M+Z2HQguvcx7AZ3BjCXiFYR0QhlWV1mzgEA5WcdvQ2JaAQRZRBRRl5e9C71kpNKB9ab3luCm95bEvZ77jt6pqS7lD/zY5jNg8G2e3fBjpi6TNbSmzNyQ4zcuOvy6gJ0T19Y/Fxdc/efkGN9gI+WevTm9HUH8K7SfmxUedBWOPYcOYO5mw6izQtzcL4gNnPNxJMpK/dF9fPt3lDtzswHiKgOgHlEZPo6hpknAJgAAGlpaVE7D2vbxQZ/sDTs4cB3fLisuJ2uTcPqmPpYt+KeO+HGiWi329mhdx/j5veXICt9UOQLE4LetxzsiirW5Oafw+7Dp4uf7zMxE5a2XpNEwIgvVwEA9h87i2ZRviEYTPweFZFjq+bOzAeUn4cATAXQGUAuEdUHAOWn9THRFthtPpm7KfBSVD3U/MSZ4AMo1M5eKAy4AbNh/wnM3FDSZquXJMyMaJ/97dgfoxMH61GfQ+PxfLp052HD14yuQAgU8FqSKtobpdoFfMeIf64ENx2LcFre0d+tj+jnuS3s4E5ElYmoqv8xgH4ANgKYDmC4stpwANPsFjIYu3mZ//zvdcWPV+8NvDve7sW5pt9Hb+j3yK/XFj/2T9q7I/dkqfXi7fLfi9Q3H/2P4un3MurbdYavLcs8ggmLMkst19bc1V0Lg53fBn+wNCJZJO//zDh1iBtXtF//Fl5F6usRXWx97k1t69va3oidmntdAEuIaB2AlQBmMvNsAOkAbiCiHQBuUJ67xslf8e3jl4W97cKt5i5Q9GbJ2a4T8BPZibMXkTp6pu6J0C16sSKOYnspW3ICv7tXZpVuMdXeb1I/jYWrl52H3M1U+bqqN8ysDeH3jOrS7BJb5Xj+ppa2tjcSdnBn5l3M3E7514qZxynLjzBzH2Zurvx0tS9frLRJz9180NR6ejUevWHjamcuFMT0jdPtuSdx2dOzTLXzmvHw574Rgje8vciR9zMjsFnG9+R0jE5gYcZME8FKG9yTVTV37dD5aBxnBUZZw+BMpW78z5l4SPlbi0QaAz1Z6YNQp1oFV9477tMP6PXICGXeU9c6Xo45m4J3I/PboHOPIFQOir/+Zz2GT1qJPUdOB10vWr75bR8KixizN5o7wYUKFOcjOG77s6W+5jJ1s4zZoQ9Zh0+jyOVxEmaYzcWu/d6TkijgpnGSTnDffCAfG7JP4KUZpVMYuN0mHiS2O3ZlMX9Lrq0TV2VV99NYE/fBfdEO6zXa5nWrOlqGPxlMvKHV47WFustD/W1lKpenwZIoOS3/3EWM/3mnqeBVPNG3yXYMZmDVnmP48tcsAL5p3tRD5yMZMMf+uBm7D5+2HCy2555Er3/8jA9/Kd2WHWl93vzF1HrarzWJCCt2l+RnIZ1mmYHvLsbN7y/BJOUkqBbuKGt1r55ggtXc5282V5kyY1lm8Bw1LetXK3689aUBAa9tenGAdvWYEffB/V/L91pa/y/9rnD089fuO47p6w6EXhFA9rHweo9sVQKfUQ+G71dnh/W+WhcLi/DFr1koKCzCSz9uxuuzt6Hv278E7TkRjuxjZ3HHh8uKZ5oaNnEl+r9T0gTj9OeFUlBYFHiZH+Ljp67JRvYxXxPUb1lHMX9zrmOD3tyk/V6TCMhSpcVQ19zPXiwM2cwWTtbDBVty0fsfP5ca/Zt/7iLemb89oIzB/gzUHSHsuveTFUFfn/HHHgCAp/pegQplS2rq7w3tUPz4oR5NHSuPU+I+uFv18LXNLK3/2dLdhn/kh/LP4VYHpmAze5CcMqgpjfp2XcClZceX5uGNOdaHTn++LAvPT9uEL5fvwcos362SXXmnMWVl8BOo1VlxQg2Q0X4fqaNn4nGX20T1BjEZWbfvRHGTwe7Dp/HQFxm46b0lMXP/x4j2e9UOYkpSRYOT5y6GzLcUzt76KyoTFu8K6GE2bsYWvDN/h+mmvUhKSiJkpQ/CyL7NA5bf3K5BwDpWNaxR0XbZgkm44F6+jLU2srE/bkbP138qft7jtYVIHT0TG/efQOdXFjhSJu0csEaCHUz+bmwnzlzE0dMX8MFP1psL8pWJEZZlHsEeVY1u7HT9uVyPnb6AMd9vKG5GeXmmcWpZtVAVc3XtzT8doZkbhHZYuVjIzDtVPKmKme/Jj5nxzNQNtmZM0kr/r/mTuPbco+2lNX9zSY+vwqLQeZfsnMzW7TuOJyaXnLC3H/KV5a15vqyKczfFXpD3y0ofVGognpXQ3rXZJXh3aAfMdeHen1pCBfcJw662tf2HP2cWN63YSU+gtfWguS5/J85eNMxX4b+x/OIMaylK1fzH8jxNe2ZBEePzZVnIOXE24IC+48NlmLJyLz7/1dqAllDNLuoZhb6MwGAZLv5PeR4iZi3ecRgf6bS1h/oeXp65BV+t2IsWz822XkgdFwqKdMthRFtz1/aNV7e///U/oZs9wgnt6kGC87ccQseX5mHrwXwcVEaFZ+b52uP3hdmEGetWPtMHU0Z0wS3tGqByeXczridUcO/Xqp6t7e1kiQtl2lrjBGF+j321GoPe1T+pLC2u4Za0/z/3w0bsPGS+r/jiIKMcX5i+CV1fXYhPl2bh8KnzaDN2Dnbp3BibsT70/Yf0EN9jNFo3AnvLuFMAbb51u7STc4QSar/UJ93jJkZnh/M1zdVUHI6evoAB7ywO+Lx35m83PZVdvKlT1Z1uj3riOrhbuSy0m89k5NfmesSEK9QlfSh62Se/XL6nOFdIMKfPFyB19MyAWpWRF2dsxpIdhw17SjwxOfT3tEjVZ1/vd6gOMnlhpm2wgjkwULlxP/fY6QtYEuTkGQ6rzbyh5yM1n24DAMb/tDP0Siap0w+/M3+HK1dsPS6vbXmbpaOvd7wckRLXwd3sQTjl4dLDg5vXsZYUadpacz1iwhUsJbBWURGXOlD9N/i0I2B35YXuix1sTkg9Tg7L1+tppA7ueimZ3aD+hj5wMGidu1iIm95bHNAj4xbVjTjAl+RrWWbwwH/Vc7MxdMLygGVWZyIaNtHZ9NDfr9mPoiJ2peuqGyf1Lx7ojJcGtwq5nnpGNrM3PYN9A8vH9DH1Hk6L6+Aequ12ZJ/m2P3qQHS9zN7w4Eiw0oe9iDlg6DTg++MyOsj8o+9SR89E6uiZOKPk8b5YWBSQ39ssdc4cu/TeS918EIlukUkEZGSVDKQ2e4M7mE8W70Lq6Jn4LesoNu7PD5jqTrtHPV//Cfd8bNwdLzPvFM5eLMSvmjlDrVQIAPP9y61o9vQsNHt6luPv64TX7mhT/Hj1czcgKYkwrGtqyO0uqVzO0XJUKu/rxKE9qbstrudQVQeBt+9uh6e+KbkJ9OZd7XDH1Y0Mty2MsW5r5wuKTGdRLGQu1T2RmQ1rubM3HcTb87YXP2/5/BxkpQ/C6O82hF9gFwX2dXb/90Tkawpwkr/nkF5t2WovE6NBSmH0vksod3dqgrs7NbG8XY/mtYt7Q5lVoUzwevLOcTdaPhnbFdc19wOqYHjdFXVQrULJuarnFcHb1264qq5r5QqXevKIYJhLN0kxgicg++eC0sHrO4cGPznl18wj+Hrl3oCA7vY0iD5kOIl0OEJ1dfTvUf65i/g2w3omwnmbc3Hs9AVX7g2E61/L92DFruAjPSOZwrfXlSlhbxtOfeLWDg2Dvl4mOSmsvvB2xHVwV/cWqFW5HMbd5rsMa9e4Rsi70t3CuLlixe0dfb/ssTc7n/FNr6miqIgx2MKAqnCaY9w29OPlGP39hoAbe+rMgG6NAnX6mPtLiNGTM9fnYPmuI2g7di7+9p/gOcR/WBPYi+rY6Qt4+IsMDHp3se4Auhb1nE2tYdazP2zE3ROWB736NNvl1wm9r9SdAM6UahXLWt6mTFLshdLYK5EF2plybmpbH+Nua43JD10TpRKVIPhGtf2hu/PDko+cKl0D0quZxyujdna3rjR+CHKzPNgkGEZmmJhYe4jm5ijgq8kv2p6HkV+vKU53/OQ3awPW+VTJ8XLAYLYw/1D5aOmevrD43o7291g9jKAZrgGtw+v2XLlcMoZ3vdTh0kRHXAd37TBxIsK911xqanDAlUrysDE3tsBtIS6pzOrTog7qKek7G9Rwrz/rtW/8VGqZ07WirPRBAbkzYoFTze/PadIuvxvkxBgq74iTpq7ej/smrcS0tQdww9uLcCi/dAD3z4tqJDmJ8I+72rlVREuW7DyMgyfOYfXeY9h28CQGvrs4Yp8d7sXYvV0uRZnkJDw76Cr0bO7M1X20bu/Fd3BXvrRwgnO96hWQlT4Ij1x3GerazKf8yHXNcEu7Bnj1jja4r5vvrF+navni1/3dLtXdsFo3rIavYuAKQ8+421oDCMydEQucurkaiVGv4XhBM9YhnPQWRIQ7r26EciFu8EXC8Ekr0eXVBbh9/LKAxHCREG6O9Ouu8LXVP9SzGb580KHjM96COxE1JqKfiGgLEW0iopHK8rFEtJ+I1ir/BjpX3EDFqWZtvk+9auVDr6QoozTQ3tKuAboqM7BUKlsG7w7tgDpVK+Dhns3wws0tMbRzyV36K5R20M5NL8HsJ3viH3e1w4w/9kR3l9v9w3XvNSWXpSuejk4fXT3hTly+eEdexNIIO5k3xo670xqbXnfzi/1dLElkNalVCR/9PniakfaNaxi+Fu4xGSzZHEXpPGvnYwsA/JmZrwLQBcDjROS/e/g2M7dX/rnWCfaaZrUAAHd3Mv+HrKdvS/M9Z7pdXhvrnu+Hd4d2QFpqzVKvl01Owv3dm6JMcslX+/odbfHR7zviynpV0aJeNdwZpIumX+Yrrp0Tg9Lmq65brQI2jO2HfiG+I/WVilvmbc7FbeOX4vCp4ANcmLl4EEzq6JkYNnElhnxcuo3bDU6nGDAj7dKaeGbgVbhL9Xf1ws0tsfq5G0xtX6lcXPeIDjD7yZ4h29vfuLOt7nK3rnaqVYjcvQY1O9Ps5TDzauXxSQBbADjTeG1So5qVkJU+CNfYnMOwUc1KGGRhktrqlQJ/WaG6r1YuXwYDWuu//7aX9ZP9JycRFv+tt+kyOUWdr9qvaoWymHBfWtDtpj/RA52b1nKrWMXW7D2OySv2Fg/E0jNh0S50Gjc/YKTpyt1HMfLrNVhlsf+yVfnnrA3hd8J//qcbHr62Gd5QtbWXSU5CLRODcaJxZWamXOEyc6JqXrcqvnywc6nldloAKuocN9HmyKmKiFIBdADgv/v0BBGtJ6JJRFS6euvbZgQRZRBRRl5e9OcHLWuyP1xVhzO56aUg/ukvvQAAjWv5Tl6P9brM0c808u9Hu4a9bb3qFfDtI10x/YnuDpZI31vztqPl83MwStOTxO9VJQ3uG3O2BSyftvYA5m9xbgYfPU4P8bdr49/7Gza7ZKUPKr7f9KSSq/zhnk2D9mrplFrT9lWale0X/6033r+nJD2udt7XP99QMvnOcxYmmm5ex9kuo27Ng2qH7eBORFUAfAfgSWbOB/AhgMsAtAeQA+BNve2YeQIzpzFzWkpK+AMOIu2V20qGNLtxF/zG1vUCclsAwN8GtHD+gxQvDW6FtEt1z79haduoBsom658of1ZOWk75fk3oTJpayREeJRhtVcqX0a3NlksOPPRH9mmOD+7piP8d0KK4A8D8Uddii2oauVE3XIHx916Nlc/0tVWm5CRC/1a+Zr5Q40Aa16qEm9o2QAWlElS/ekkQveeaJvhjn+bFs6v5b4aaUa966WAc6RGkbrNVDSWisvAF9q+Y+XsAYOZc1esfA5hhq4QRYjZOq5tk/DdRnPyT+DDEzSCn9WyeUjy5dziDeVY83adU19P+rephxvocVK1QBj883h1JRNh2MB+pmpOWEy4UFFlqK33fwaRgseDXMdazFg7p1Bi/7xLYl5uIipsmx9/bEdPXHcBlKVUCkpP9qU/gTEThalSzIsoqJ5daVczV4v1XE9e3qIMvlLz5/3Od74r2sV6XY3D7hmhcq5KtcnksttvqLUMAJgLYwsxvqZarG5dvA7BRu20sMtOZQnsjxurE0EZm/akngOCXq3dd3ai4b77T3vpdOzzR+3J0aGytBr/lxQGoW60CqmiCu79H0YuDW+GylCpoWrty8T2HHx53ttnG7WaWWFe/uvWp2tLvaIvWDasbvl6nWgU81LOZ5ayTWh2b1NBdPqxLqqnKVDNVZaB6pbJYPqYPnlc1vfiDeVIS2Q7sgLOVtFhgp1mmO4BhAK7XdHt8nYg2ENF6AL0BPOVEQd2mTeakF4SMernYPQhaNqiGZaOvx/w/X2e4zht3tcMcF6blIvIdzH/pf6Xl3BcVy+nfRPJ/H3rNVu0b18DQzoG9m7a8OACTHw6vT/E3v1nPzZLI/Gkx7Bp1Q/CJ5h+5thm+f0z/RJ5EwB1KOTpouiW2a2R80qlXvUJALzQRnJ3eMkuYmZi5rbrbIzMPY+Y2yvJbmNndyS8d0q5RjYDnTTQ1gSvrVrUdxINpUKOiqS5Ty1STB4y4thm+fSTwJmiPy2vj9iCDurTt+dFw59UlwX1kn+aoWC4Z3S4Lr3/xL9vt3Ywf6VBTg5PqVauAOzoad5d9wEZKi3AmrHhpcCvcpxmS/7sQ/ej9TTiXXlK6Rk1EuL5FXWSlDypV4572REn6hCtculI14ubxHQ1yGlQ80CPwgNHW5PV+79EYeNagRkXc2t43crRFvaqoWiGwSYTI19XLyJOaGdy1+Xmc4E9e1cBgooOrL62Jh5TvW9v7IZJeurU1ejg0xBwA/jmkvaX12+rUUj+5Lw1TH++GUf0Ca8bq3OTP20hGd1X9apa3GdY1FS8Obm1pm2ApQIyu+LTe/J1+GoWPft/RVs8uIx6L7RLc/dRBpozJgHON0q+7YxPnepuY0Ua5ymhSq1Kppo9Hr7sMfa8yzohXNjkJ3z/Wrfi5G3/QD/dshmmPd0eXIOMPhl7TBGWSKGACg9+e6WtpvIEdC/58HYZ1udRSD4lP/9Ap6OuD2+tfMRkNSPvhse6oXaV8QA6Tvi3ron71igGn3EFt6uPuTk2wfEwf7H41vMFtjWr6TrRO/b6DjchU06aM6NOiTtARomqVDE4CA1rXR6dU58dUOHUotAzjBOoGCe46Zj/Z09Sfbq8r62D92H4Rn+npge6pmP1kT6Sl1go4eLLSB6H75bWD1twB38nI36WztsneClYkJRHahTiAL0upgp2vDAzoQZNStTw+uKej5c87qRo4ZHb4vz9jobbNNxjt4DW1T4IM8lJXHHapAn1SEiHj2b7455DgCdpSlBvt9apXCLvpwB8o3bhS0+qqOqlrKx93WUiLEOlmkl420gSrxcoVgAR3HZdbGOAQjaHFRIQW9ezVDu65pgmy0geZvkSOZW3GzsWkJb5UuC2em21qmxTlpKa+iTzvqWuDDlK73GDe3dfvaKubwuKFm1ti/qjAm+R6N61DjdgMdgVk1lN9fc08jWtZ712jJ9gYD/X+aNeLlcCnp0oF76RhACS4Gyr9Rxmbf5X+mnubIF3b1GJsdkFDVoPQizM2W1pf3RwzYdjVmPpYNzSvWxWPGowG/v6xboYn8tt0eqBsGNsP93dvanhCCKWsqldIuLnJ1W5sUx9Z6YMik0fG4qFitpkmXmg7Y0SLBHcDRqMsY02rBtUxtHPjUjfz/tr/SgC+7JVZ6YPw7KCrAMTOH14w68f2w7ynjLuFGrnl/SWm11XfiO7Xqh46hLhvYjQGISt9UEAgXvVsX0wcnoaqNq/oUiKQiM2OYHUE9YnTzHyxd6WFTqQXCU5VfIZ0tj5vqxu8dR1i049P9EBlZabyGpXKoWGNiqYnrY6W5CTCq7eXznLnH0J+fQtfO+KDPZqi71V1XRkl6rRwm7rWZ5ufhs9qn369fCtddZpLLqlSHn0cmp+3Q5MaGGiQcG7qY92wLDP4nKVuCha01d+smXjZ9JLY/5u0IlaqhRLcVdpouqYNaF0PE5W23HjTr1U9zH6yZ/GoViKKi8CuVq1CGeSfM87+6Aa9oFW7Snndmvjg9s5NZjLqhitK9QCZajAICAA6NKkZ8mrDTZWDNO+oWzDN1IbjpKXQNPX+aLseR5I0y5j091tahV4pxrSoV83RewUD29hv+7Xiyb7BR0G6Qe/7emZQSeI29XdQo1J4qWtXPdu3VE6YP/VpHvFeV3bUrFwO79zdXvc1dToKbZfJYMm9uin736WZ+6mjIyUaf8N+EtyDUNc6IpGrPNaNvzeySc0e6NHUlQkUgnX/1Ov33qpByRXdu0M6YMPYfvjkvrTizIZWXVKlfFg5YWJN/1b1Sv1+/tr/SowZeJXque/EOKzLpdgx7kbd+QIqlPW9R03lZDnl4S4BXUbdUnr8gTPXEGbuM0SCNMuI2GbjOOnXsi7mbi6dWOzhnsbD9/Wa4tWLyiQnoWpykqXZu7yqYrlkbH/5RqSOnlm87PHelwesc+fVjULOPNaxSU28NLgVblEGgRFRRLpMujU6OlZ61knNXcQ0/2W9enJxs0LNHqVHr+YeI8dqzHshzLQIRIRhXVODThIST6TmHgfkoI4dRnlqjGgHD6n1b2V878D/O29Rryq2Fs+Hav8PYdFfe5caiu8199tIaCacJzV3EdMuVbrJWT3R6g0eSru0JrLSBwXtNeSvuXdQ5SKvW81+n/Mml1SKu95Kicapc2+snMKl5i5i2uSHr8H6fSeQ5kCiqLaatM56/N1hu19eG1NW+nLF2x2Q5HXPDroKR05fiHYxhIbU3IPolBq9fsTCp07VCujbsi6qVSiLx3v7UgNcXqcKPn+gs+G0b188UHpm+95XpuDRXs1Cfl6n1Fr47Zm+uKmtc33Yve6hns3wvy7O8xsJ17eog5EO9Ulvb6ISEQmu1dyJaACAfwJIBvAJM6e79VluaVnfV4vzp0sVJazmLnfCX/u3KO5aB/j6TH+3Khsv39Ya93/6GwDg9g4Nca2qL/W0x7ujdtXyaGihzT7Wh/4L5yQnEQqLGJNCpHM2q0wSoWaIRHCR4kpwJ6JkAB8AuAFANoDfiGg6M1vL7hRl/oyJkZ4RJpa9dkcb7D58xjB3eaQtHR04GOgtzcCaUKmHRWIzyrUfjskPX1Ocu+mz+zuhoDC6re9u1dw7A9jJzLsAgIi+BjAYQFwF95Sq5TH5oWtKpSVIZHd3io2kSFqT/pDm+ME0/YnuWGchX41IbOqpIp3KDW+HW8G9IQD1zMXZAAJmQCaiEQBGAECTJrEZMACgWxhzTorIu76F84OK2jaqYeomrBCxyK0bqnod1wKqVcw8gZnTmDktJcU434QQQgjr3Aru2QDU82k1AnDApc8SQgih4VZw/w1AcyJqSkTlAAwBMN2lzxJCCKHhSps7MxcQ0RMA5sDXFXISM29y47OEEEKU5lo/d2aeBWCWW+8vhBDCmIxQFUIID5LgLoQQHiTBXQghPIhiIbE8EeUB2GPjLWoDOOxQcWKZ7Ke3yH56SzT281Jm1h0oFBPB3S4iymBm69PuxBnZT2+R/fSWWNtPaZYRQggPkuAuhBAe5JXgPiHaBYgQ2U9vkf30lpjaT0+0uQshhAjklZq7EEIIFQnuQgjhQXEd3IloABFtI6KdRDQ62uUxg4gmEdEhItqoWlaLiOYR0Q7lZ03Va2OU/dtGRP1Vy68mog3Ka+8SESnLyxPRN8ryFUSUGtEd9JWhMRH9RERbiGgTEY304n4q5ahARCuJaJ2yr39XlntxX5OJaA0RzVCee24flbJkKWVcS0QZyrL421dmjst/8GWbzATQDEA5AOsAtIx2uUyU+1oAHQFsVC17HcBo5fFoAK8pj1sq+1UeQFNlf5OV11YC6ArfxCj/BXCjsvwxAB8pj4cA+CYK+1gfQEflcVUA25V98dR+Kp9NAKooj8sCWAGgi0f3dRSAyQBmePHvVrWfWQBqa5bF3b5G5ctz6BfQFcAc1fMxAMZEu1wmy56KwOC+DUB95XF9ANv09gm+FMpdlXW2qpYPBfB/6nWUx2XgGzFHUd7fafBNlu71/awEYDV8U0p6al/hm3BnAYDrURLcPbWPqnJloXRwj7t9jedmGb15WhtGqSx21WXmHABQfvpn1zXax4bKY+3ygG2YuQDACQCXuFbyEJRLzg7w1Wg9uZ9Kc8VaAIcAzGNmL+7rOwD+BqBItcxr++jHAOYS0SryzfUMxOG+upbPPQJCztPqAUb7GGzfY+Z7IaIqAL4D8CQz5ytNjrqr6iyLm/1k5kIA7YmoBoCpRNQ6yOpxt69EdBOAQ8y8ioh6mdlEZ1lM76NGd2Y+QER1AMwjoq1B1o3ZfY3nmruX5mnNJaL6AKD8PKQsN9rHbOWxdnnANkRUBkB1AEddK7kBIioLX2D/ipm/VxZ7bj/VmPk4gJ8BDIC39rU7gFuIKAvA1wCuJ6J/wVv7WIyZDyg/DwGYCqAz4nBf4zm4e2me1ukAhiuPh8PXRu1fPkS5u94UQHMAK5XLwpNE1EW5A3+fZhv/e90JYCErjXuRopRpIoAtzPyW6iVP7ScAEFGKUmMHEVUE0BfAVnhoX5l5DDM3YuZU+I6zhcz8e3hoH/2IqDIRVfU/BtAPwEbE475G44aFgzc+BsLXEyMTwDPRLo/JMk8BkAPgInxn8Afha29bAGCH8rOWav1nlP3bBuVuu7I8Db4/ukwA76NktHEFAP8GsBO+u/XNorCPPeC7zFwPYK3yb6DX9lMpR1sAa5R93QjgeWW55/ZVKUsvlNxQ9dw+wtf7bp3yb5M/rsTjvkr6ASGE8KB4bpYRQghhQIK7EEJ4kAR3IYTwIAnuQgjhQRLchRDCgyS4CyGEB0lwF0IID/p/PxDz5il3qmgAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> 
                        <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

model                                 new_rnn
input_size_multiplier                       7
output_size                                24
dilations                       [[1, 2], [7]]
es_component                   multiplicative
cell_type                                LSTM
state_hsize                                50
add_nl_layer                            False
seasonality                              [24]
n_iterations                               10
early_stopping                             10
eval_freq                                  10
batch_size                                 32
learning_rate                          0.0005
lr_scheduler_step_size                    100
lr_decay                                  0.8
per_series_lr_multip                      1.5
gradient_eps                              0.0
gradient_clipping_threshold                20
rnn_weight_decay                          0.0
noise_std                              0.0005
level_variability_penalty                  10
testing_percentile                         50
training_percentile                        50
random_seed                                 1
loss                                     SMYL
val_loss                                  MAE
len_sample_chunks                         672
window_sampling_limit                  500000
complete_inputs                          True
complete_sample                          True
idx_to_sample_freq                         24
val_idx_to_sample_freq                     24
n_series_per_batch                          1
normalizer_y                             None
normalizer_x                             None
dtype: object
===============================================

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All windows constructed will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

============================== Start fitting ==============================
Step: 10, Time: 6.135, Insample SMYL: 0.06189, Outsample MAE: 3.52667
Step: 10, Time: 6.341, Insample SMYL: 0.06189, Outsample MAE: 3.52667
==============================  End fitting  ==============================


y_true.shape (#n_series, #n_fcds, #lt): (728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (728, 24)


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 3.526671897428922,
 &#39;mc&#39;: {&#39;model&#39;: &#39;new_rnn&#39;,
  &#39;input_size_multiplier&#39;: 7,
  &#39;output_size&#39;: 24,
  &#39;dilations&#39;: [[1, 2], [7]],
  &#39;es_component&#39;: &#39;multiplicative&#39;,
  &#39;cell_type&#39;: &#39;LSTM&#39;,
  &#39;state_hsize&#39;: 50,
  &#39;add_nl_layer&#39;: False,
  &#39;seasonality&#39;: [24],
  &#39;n_iterations&#39;: 10,
  &#39;early_stopping&#39;: 10,
  &#39;eval_freq&#39;: 10,
  &#39;batch_size&#39;: 32,
  &#39;learning_rate&#39;: 0.0005,
  &#39;lr_scheduler_step_size&#39;: 100,
  &#39;lr_decay&#39;: 0.8,
  &#39;per_series_lr_multip&#39;: 1.5,
  &#39;gradient_eps&#39;: 1e-08,
  &#39;gradient_clipping_threshold&#39;: 20,
  &#39;rnn_weight_decay&#39;: 0.0,
  &#39;noise_std&#39;: 0.0005,
  &#39;level_variability_penalty&#39;: 10,
  &#39;testing_percentile&#39;: 50,
  &#39;training_percentile&#39;: 50,
  &#39;random_seed&#39;: 1,
  &#39;loss&#39;: &#39;SMYL&#39;,
  &#39;val_loss&#39;: &#39;MAE&#39;,
  &#39;len_sample_chunks&#39;: 672,
  &#39;window_sampling_limit&#39;: 500000,
  &#39;complete_inputs&#39;: True,
  &#39;complete_sample&#39;: True,
  &#39;idx_to_sample_freq&#39;: 24,
  &#39;val_idx_to_sample_freq&#39;: 24,
  &#39;n_series_per_batch&#39;: 1,
  &#39;normalizer_y&#39;: None,
  &#39;normalizer_x&#39;: None},
 &#39;y_true&#39;: array([[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
        [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
        [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
        ...,
        [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
        [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
        [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]], dtype=float32),
 &#39;y_hat&#39;: array([[24.471796, 23.748716, 21.534275, ..., 28.559456, 27.848616,
         24.721869],
        [24.176455, 23.52666 , 21.318289, ..., 29.181852, 27.24518 ,
         24.66038 ],
        [27.095896, 27.567408, 24.549124, ..., 32.397522, 30.085363,
         28.386732],
        ...,
        [47.903854, 50.48991 , 48.904118, ..., 52.555866, 49.208046,
         46.79444 ],
        [49.41624 , 52.037766, 48.101055, ..., 53.400776, 52.586205,
         49.238014],
        [50.35027 , 53.55197 , 51.83186 , ..., 55.88411 , 52.94162 ,
         49.100086]], dtype=float32),
 &#39;trajectories&#39;: {&#39;iteration&#39;: [10],
  &#39;train_loss&#39;: [0.06188508868217468],
  &#39;val_loss&#39;: [3.526672]},
 &#39;run_time&#39;: 11.305035591125488,
 &#39;status&#39;: &#39;ok&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f84b4588610&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.015084 seconds
INFO:hyperopt.tpe:TPE using 0 trials
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================      

activation                                selu       
batch_normalization                      False
batch_size                                 256
complete_inputs                          False
complete_sample                          False
device                                    cuda
dropout_prob_exogenous                0.442432
dropout_prob_theta                    0.178009
early_stopping                              16
eval_freq                                   50
exogenous_n_channels                       2.0
frequency                                    H
idx_to_sample_freq                          24
initialization                   glorot_normal
input_size_multiplier                        7
l1_theta                                     0
learning_rate                          0.00071
len_sample_chunks                         None
loss                                       MAE
loss_hypar                                 0.5
lr_decay                              0.415965
model                                   nbeats
n_blocks                                (1, 1)
n_harmonics                                  1
n_hidden                                   364
n_iterations                                10
n_layers                                (2, 2)
n_lr_decay_steps                             3
n_polynomials                                2
n_series_per_batch                           1
n_val_weeks                                104
normalizer_x                            median
normalizer_y                              None
output_size                                 24
random_seed                               19.0
seasonality                                 24
shared_weights                           False
stack_types               (identity, identity)
val_idx_to_sample_freq                      24
val_loss                                   MAE
weight_decay                          0.004299
window_sampling_limit                   100000
x_s_n_hidden                                 0
dtype: object
===============================================      

  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All windows constructed will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.093, Insample MAE: 2.98452, Outsample MAE: 2.78855
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24) 
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)  
 50%|     | 1/2 [00:02&lt;00:02,  2.21s/trial, best loss: 2.788546562194824]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.011174 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 2.788547
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================                               

activation                                     selu                           
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                         cuda
dropout_prob_exogenous                     0.346281
dropout_prob_theta                          0.27502
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                            2.0
frequency                                         H
idx_to_sample_freq                               24
initialization                        glorot_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000814
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.347262
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    11.0
seasonality                                      24
shared_weights                                False
stack_types               (identity, exogenous_tcn)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                                0.00124
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================                               

 50%|     | 1/2 [00:02&lt;00:02,  2.21s/trial, best loss: 2.788546562194824]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

WARNING:root:Batch size will be ignored (shuffle=False). All windows constructed will be used to train.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================   
Step: 10, Time: 0.227, Insample MAE: 3.20161, Outsample MAE: 3.37124          
==============================  End fitting  ==============================   
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                          
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                           
100%|| 2/2 [00:04&lt;00:00,  2.13s/trial, best loss: 2.788546562194824]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">trials</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;state&#39;: 2,
  &#39;tid&#39;: 0,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 2.788546562194824,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cuda&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.44243247873431857,
    &#39;dropout_prob_theta&#39;: 0.17800903521584777,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 2.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0007096869237709948,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.41596452409629736,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 19.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.004299242516718091,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[24.631153, 24.287922, 24.506996, ..., 26.76231 , 27.207346,
            25.720295],
           [24.6842  , 24.591791, 24.469683, ..., 27.10711 , 27.134094,
            25.663012],
           [28.277172, 28.423742, 28.03599 , ..., 30.871584, 30.912191,
            29.32502 ],
           ...,
           [48.779182, 47.303177, 46.91323 , ..., 51.82939 , 50.26953 ,
            49.11067 ],
           [51.057323, 48.526413, 48.93889 , ..., 52.17636 , 52.734188,
            50.717556],
           [52.820923, 50.909126, 50.72835 , ..., 53.79596 , 54.619785,
            52.75155 ]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.157083034515381,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 0,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.44243247873431857],
    &#39;dropout_prob_theta&#39;: [0.17800903521584777],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [2.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0007096869237709948],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.41596452409629736],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [19.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.004299242516718091],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 4, 28, 16, 6, 39, 270000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 4, 28, 16, 6, 41, 455000)},
 {&#39;state&#39;: 2,
  &#39;tid&#39;: 1,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 3.3712358474731445,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cuda&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.3462810470658893,
    &#39;dropout_prob_theta&#39;: 0.2750201328861364,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 2.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0008139369542227633,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.34726178826983956,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 11.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;exogenous_tcn&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.001240445994975849,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[24.185753, 24.302889, 25.26466 , ..., 27.31147 , 27.4814  ,
            25.175795],
           [24.188644, 24.490522, 25.38249 , ..., 27.589739, 27.666838,
            25.61547 ],
           [27.749802, 28.139685, 28.786064, ..., 31.146708, 31.315456,
            28.794985],
           ...,
           [45.847168, 44.368458, 47.307606, ..., 51.57906 , 50.718994,
            47.599464],
           [47.953472, 46.433296, 48.958836, ..., 52.54254 , 52.72199 ,
            48.90905 ],
           [50.54362 , 49.17876 , 50.77946 , ..., 55.91175 , 55.821754,
            50.6941  ]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.019470691680908,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 1,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [1],
    &#39;batch_normalization&#39;: [1],
    &#39;batch_size&#39;: [1],
    &#39;complete_inputs&#39;: [1],
    &#39;complete_sample&#39;: [1],
    &#39;device&#39;: [1],
    &#39;dropout_prob_exogenous&#39;: [1],
    &#39;dropout_prob_theta&#39;: [1],
    &#39;early_stopping&#39;: [1],
    &#39;eval_freq&#39;: [1],
    &#39;exogenous_n_channels&#39;: [1],
    &#39;frequency&#39;: [1],
    &#39;idx_to_sample_freq&#39;: [1],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [1],
    &#39;l1_theta&#39;: [1],
    &#39;learning_rate&#39;: [1],
    &#39;len_sample_chunks&#39;: [1],
    &#39;loss&#39;: [1],
    &#39;loss_hypar&#39;: [1],
    &#39;lr_decay&#39;: [1],
    &#39;n_blocks&#39;: [1],
    &#39;n_harmonics&#39;: [1],
    &#39;n_hidden&#39;: [1],
    &#39;n_iterations&#39;: [1],
    &#39;n_layers&#39;: [1],
    &#39;n_lr_decay_steps&#39;: [1],
    &#39;n_polynomials&#39;: [1],
    &#39;n_series_per_batch&#39;: [1],
    &#39;n_val_weeks&#39;: [1],
    &#39;normalizer_x&#39;: [1],
    &#39;normalizer_y&#39;: [1],
    &#39;output_size&#39;: [1],
    &#39;random_seed&#39;: [1],
    &#39;seasonality&#39;: [1],
    &#39;shared_weights&#39;: [1],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [1],
    &#39;val_loss&#39;: [1],
    &#39;weight_decay&#39;: [1],
    &#39;window_sampling_limit&#39;: [1],
    &#39;x_s_n_hidden&#39;: [1]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.3462810470658893],
    &#39;dropout_prob_theta&#39;: [0.2750201328861364],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [2.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0008139369542227633],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.34726178826983956],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [11.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.001240445994975849],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 4, 28, 16, 6, 41, 472000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 4, 28, 16, 6, 43, 513000)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

