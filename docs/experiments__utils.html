---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "Set of functions to easily perform experiments."
description: "Set of functions to easily perform experiments."
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>ds_in_test</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>n_ds_val_window</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>freq</code></strong>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ds_in_test: int
    Number of ds in test.
n_uids: int
    Number of unique ids in validation.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
periods: int
    ds_in_test multiplier.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>mask_df</code></strong>, <strong><code>normalizer_y</code></strong>, <strong><code>normalizer_x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>, <strong><code>train_dataset</code></strong>, <strong><code>val_dataset</code></strong>, <strong><code>test_dataset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L254" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L286" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L315" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L322" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L376" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>loss_kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L423" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>, <strong><code>hyperopt_max_evals</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>save_trials</code></strong>=<em><code>False</code></em>, <strong><code>loss_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">from</span> <span class="nn">nixtla.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">smape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">pinball_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>  

<span class="n">nbeats_space</span><span class="o">=</span> <span class="p">{</span><span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;shared_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;selu&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;initialization&#39;</span><span class="p">:</span>  <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;initialization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span><span class="s1">&#39;he_normal&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;stack_types&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_blocks&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_layers&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">364</span> <span class="p">]),</span>
               <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_harmonics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_polynomials&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;weight_decay&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-3</span><span class="p">)),</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span> <span class="c1">#[args.max_epochs]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_val_weeks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss_hypar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]),</span>                
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span> <span class="c1">#[args.val_loss]),</span>
               <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;l1_theta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>                
               <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>      
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">device</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span>
      <span class="s1">&#39;initialization&#39;</span><span class="p">:</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
      <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
      <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span>
      <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1">#0.002,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
      <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00015</span><span class="p">,</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;PINBALL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="c1">#0.49,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">100_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_space</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;esrnn&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
               <span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;dilations&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span> <span class="p">]),</span>
               <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;es_component&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LSTM&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;state_hsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;add_nl_layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">]),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
               <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
               <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-8</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]),</span>
               <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;noise_std&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;testing_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;training_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SMYL&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">500_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="kc">None</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;esrnn&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]],</span>
      <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span>
      <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="c1">#00,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
      <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> 
      <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;SMYL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">500_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">instantiate_esrnn</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nixtla.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span><span class="p">,</span> <span class="n">EPFInfo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>

<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
<span class="n">Y_min</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="c1">#Y_df.y = Y_df.y - Y_min + 20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> 
                        <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

model                                   esrnn
mode                                     full
input_size_multiplier                       7
output_size                                24
dilations                       [[1, 2], [7]]
es_component                   multiplicative
cell_type                                LSTM
state_hsize                                50
add_nl_layer                            False
seasonality                              [24]
n_iterations                               10
early_stopping                             10
eval_freq                                  10
batch_size                                 32
learning_rate                          0.0005
lr_scheduler_step_size                    100
lr_decay                                  0.8
per_series_lr_multip                      1.5
gradient_eps                              0.0
gradient_clipping_threshold                20
rnn_weight_decay                          0.0
noise_std                              0.0005
level_variability_penalty                  10
testing_percentile                         50
training_percentile                        50
random_seed                                 1
loss                                     SMYL
val_loss                                  MAE
len_sample_chunks                         672
window_sampling_limit                  500000
complete_inputs                          True
idx_to_sample_freq                         24
val_idx_to_sample_freq                     24
n_series_per_batch                          1
normalizer_y                             None
normalizer_x                             None
dtype: object
===============================================

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

============================== Start fitting ==============================
Step: 10, Time: 17.585, Insample SMYL: 0.06312, Outsample MAE: 3.53605
Step: 10, Time: 17.710, Insample SMYL: 0.06312, Outsample MAE: 3.53605
==============================  End fitting  ==============================


y_true.shape (#n_series, #n_fcds, #lt): (728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (728, 24)


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 3.5360545759044943,
 &#39;mc&#39;: {&#39;model&#39;: &#39;esrnn&#39;,
  &#39;mode&#39;: &#39;full&#39;,
  &#39;input_size_multiplier&#39;: 7,
  &#39;output_size&#39;: 24,
  &#39;dilations&#39;: [[1, 2], [7]],
  &#39;es_component&#39;: &#39;multiplicative&#39;,
  &#39;cell_type&#39;: &#39;LSTM&#39;,
  &#39;state_hsize&#39;: 50,
  &#39;add_nl_layer&#39;: False,
  &#39;seasonality&#39;: [24],
  &#39;n_iterations&#39;: 10,
  &#39;early_stopping&#39;: 10,
  &#39;eval_freq&#39;: 10,
  &#39;batch_size&#39;: 32,
  &#39;learning_rate&#39;: 0.0005,
  &#39;lr_scheduler_step_size&#39;: 100,
  &#39;lr_decay&#39;: 0.8,
  &#39;per_series_lr_multip&#39;: 1.5,
  &#39;gradient_eps&#39;: 1e-08,
  &#39;gradient_clipping_threshold&#39;: 20,
  &#39;rnn_weight_decay&#39;: 0.0,
  &#39;noise_std&#39;: 0.0005,
  &#39;level_variability_penalty&#39;: 10,
  &#39;testing_percentile&#39;: 50,
  &#39;training_percentile&#39;: 50,
  &#39;random_seed&#39;: 1,
  &#39;loss&#39;: &#39;SMYL&#39;,
  &#39;val_loss&#39;: &#39;MAE&#39;,
  &#39;len_sample_chunks&#39;: 672,
  &#39;window_sampling_limit&#39;: 500000,
  &#39;complete_inputs&#39;: True,
  &#39;idx_to_sample_freq&#39;: 24,
  &#39;val_idx_to_sample_freq&#39;: 24,
  &#39;n_series_per_batch&#39;: 1,
  &#39;normalizer_y&#39;: None,
  &#39;normalizer_x&#39;: None},
 &#39;y_true&#39;: array([[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
        [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
        [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
        ...,
        [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
        [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
        [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]], dtype=float32),
 &#39;y_hat&#39;: array([[24.416636, 23.664515, 21.579985, ..., 28.753365, 27.85214 ,
         24.89599 ],
        [24.161282, 23.453922, 21.419825, ..., 29.362602, 27.345419,
         24.82762 ],
        [27.023785, 27.39488 , 24.627703, ..., 32.612907, 30.117   ,
         28.561586],
        ...,
        [47.812035, 50.22012 , 49.058426, ..., 52.906853, 49.202904,
         47.071926],
        [49.384483, 51.88936 , 48.27726 , ..., 53.67844 , 52.63621 ,
         49.577503],
        [50.25384 , 53.31052 , 51.869633, ..., 56.32572 , 52.999928,
         49.390186]], dtype=float32),
 &#39;trajectories&#39;: {&#39;iteration&#39;: [10],
  &#39;train_loss&#39;: [0.0631188377737999],
  &#39;val_loss&#39;: [3.5360548]},
 &#39;run_time&#39;: 19.81842279434204,
 &#39;status&#39;: &#39;ok&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f14801d2a50&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.009621 seconds
INFO:hyperopt.tpe:TPE using 0 trials
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

activation                                     selu
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                          cpu
dropout_prob_exogenous                     0.102931
dropout_prob_theta                         0.229007
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                            7.0
frequency                                         H
idx_to_sample_freq                               24
initialization                            he_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000666
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.362066
mode                                         simple
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    10.0
seasonality                                      24
shared_weights                                False
stack_types               (identity, exogenous_tcn)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                               0.001733
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================

  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 2.869, Insample MAE: 3.79531, Outsample MAE: 3.83893
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)
 50%|     | 1/2 [00:04&lt;00:04,  4.85s/trial, best loss: 3.838925361633301]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.041406 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 3.838925
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

activation                                selu
batch_normalization                      False
batch_size                                 256
complete_inputs                          False
complete_sample                          False
device                                     cpu
dropout_prob_exogenous                0.156746
dropout_prob_theta                     0.13804
early_stopping                              16
eval_freq                                   50
exogenous_n_channels                       3.0
frequency                                    H
idx_to_sample_freq                          24
initialization                   glorot_normal
input_size_multiplier                        7
l1_theta                                     0
learning_rate                         0.000892
len_sample_chunks                         None
loss                                       MAE
loss_hypar                                 0.5
lr_decay                               0.38856
mode                                    simple
model                                   nbeats
n_blocks                                (1, 1)
n_harmonics                                  1
n_hidden                                   364
n_iterations                                10
n_layers                                (2, 2)
n_lr_decay_steps                             3
n_polynomials                                2
n_series_per_batch                           1
n_val_weeks                                104
normalizer_x                            median
normalizer_y                              None
output_size                                 24
random_seed                               17.0
seasonality                                 24
shared_weights                           False
stack_types               (identity, identity)
val_idx_to_sample_freq                      24
val_loss                                   MAE
weight_decay                          0.002271
window_sampling_limit                   100000
x_s_n_hidden                                 0
dtype: object
===============================================

 50%|     | 1/2 [00:04&lt;00:04,  4.85s/trial, best loss: 3.838925361633301]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.791, Insample MAE: 2.56729, Outsample MAE: 2.77655
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)
100%|| 2/2 [00:07&lt;00:00,  3.83s/trial, best loss: 2.776549816131592]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">trials</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;state&#39;: 2,
  &#39;tid&#39;: 0,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 3.838925361633301,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.10293137727754714,
    &#39;dropout_prob_theta&#39;: 0.229006510872594,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 7.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;he_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0006658636162338769,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.362065860950846,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 10.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;exogenous_tcn&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.001733261367933382,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[24.177261, 23.408297, 18.76159 , ..., 25.868736, 25.76585 ,
            21.887207],
           [24.049286, 23.08006 , 18.507637, ..., 25.60667 , 25.520329,
            21.847252],
           [27.734095, 26.216835, 22.218523, ..., 29.209229, 29.052568,
            25.578627],
           ...,
           [46.71295 , 45.668793, 38.70193 , ..., 52.147522, 50.336025,
            44.62776 ],
           [48.103302, 46.298588, 39.146408, ..., 51.222042, 51.32886 ,
            44.559177],
           [50.530464, 48.46814 , 41.53494 , ..., 54.170055, 53.856075,
            47.125183]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 4.810622692108154,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 0,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.10293137727754714],
    &#39;dropout_prob_theta&#39;: [0.229006510872594],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [7.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0006658636162338769],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.362065860950846],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [10.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.001733261367933382],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 11, 1, 14, 44, 489000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 11, 1, 14, 49, 321000)},
 {&#39;state&#39;: 2,
  &#39;tid&#39;: 1,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 2.776549816131592,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.1567462385680754,
    &#39;dropout_prob_theta&#39;: 0.13803987864049844,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 3.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0008920620273031626,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.38856031039790817,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 17.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.0022711437769459895,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[25.119667, 24.42353 , 24.131014, ..., 28.0805  , 27.182219,
            26.150246],
           [25.255527, 24.367674, 24.423178, ..., 27.769308, 26.835442,
            26.100397],
           [29.006447, 27.783787, 27.99723 , ..., 30.991594, 30.114107,
            29.773054],
           ...,
           [48.526836, 47.577637, 46.23292 , ..., 52.281677, 50.261982,
            49.238514],
           [49.550133, 49.80513 , 47.809128, ..., 54.023346, 52.483326,
            50.865395],
           [49.89678 , 51.879707, 49.032417, ..., 56.682846, 54.609047,
            52.76045 ]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.704228639602661,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 1,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [1],
    &#39;batch_normalization&#39;: [1],
    &#39;batch_size&#39;: [1],
    &#39;complete_inputs&#39;: [1],
    &#39;complete_sample&#39;: [1],
    &#39;device&#39;: [1],
    &#39;dropout_prob_exogenous&#39;: [1],
    &#39;dropout_prob_theta&#39;: [1],
    &#39;early_stopping&#39;: [1],
    &#39;eval_freq&#39;: [1],
    &#39;exogenous_n_channels&#39;: [1],
    &#39;frequency&#39;: [1],
    &#39;idx_to_sample_freq&#39;: [1],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [1],
    &#39;l1_theta&#39;: [1],
    &#39;learning_rate&#39;: [1],
    &#39;len_sample_chunks&#39;: [1],
    &#39;loss&#39;: [1],
    &#39;loss_hypar&#39;: [1],
    &#39;lr_decay&#39;: [1],
    &#39;n_blocks&#39;: [1],
    &#39;n_harmonics&#39;: [1],
    &#39;n_hidden&#39;: [1],
    &#39;n_iterations&#39;: [1],
    &#39;n_layers&#39;: [1],
    &#39;n_lr_decay_steps&#39;: [1],
    &#39;n_polynomials&#39;: [1],
    &#39;n_series_per_batch&#39;: [1],
    &#39;n_val_weeks&#39;: [1],
    &#39;normalizer_x&#39;: [1],
    &#39;normalizer_y&#39;: [1],
    &#39;output_size&#39;: [1],
    &#39;random_seed&#39;: [1],
    &#39;seasonality&#39;: [1],
    &#39;shared_weights&#39;: [1],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [1],
    &#39;val_loss&#39;: [1],
    &#39;weight_decay&#39;: [1],
    &#39;window_sampling_limit&#39;: [1],
    &#39;x_s_n_hidden&#39;: [1]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.1567462385680754],
    &#39;dropout_prob_theta&#39;: [0.13803987864049844],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [3.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0008920620273031626],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.38856031039790817],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [17.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.0022711437769459895],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 11, 1, 14, 49, 373000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 11, 1, 14, 52, 129000)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

