---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "This notebook contains a set of functions to easily perform experiments on time series datasets. In this notebook you can see functions for:"
description: "This notebook contains a set of functions to easily perform experiments on time series datasets. In this notebook you can see functions for:"
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>In the next two scetion you can see enviroment variables and imports that are used for set of functions shown in this notebook.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Helper-functions-that-represent-basic-use-of-neuralforecast-library:">Helper functions that represent basic use of neuralforecast library:<a class="anchor-link" href="#Helper-functions-that-represent-basic-use-of-neuralforecast-library:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>ds_in_val</code></strong>:<code>int</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Generates train, test and validation mask.
Train mask begins by avoiding ds_in_test.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
ds_in_val: int
    Number of ds in validation.
ds_in_test: int
    Number of ds in test.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>train_mask_df: pd.DataFrame
    Train mask dataframe.
val_mask_df: pd.DataFrame
    Validation mask dataframe.
test_mask_df: pd.DataFrame
    Test mask dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>, <strong><code>n_val_windows</code></strong>:<code>int</code>, <strong><code>n_ds_val_window</code></strong>:<code>int</code>, <strong><code>n_uids</code></strong>:<code>int</code>, <strong><code>freq</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
ds_in_test: int
    Number of ds in test.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
n_uids: int
    Number of unique ids in validation.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>train_mask_df: pd.DataFrame
    Train mask dataframe.
val_mask_df: pd.DataFrame
    Validation mask dataframe.
test_mask_df: pd.DataFrame
    Test mask dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>, <strong><code>mask_df</code></strong>:<code>DataFrame</code>, <strong><code>normalizer_y</code></strong>:<code>str</code>, <strong><code>normalizer_x</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Scales input data accordingly to given normalizer parameters.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y']
mask_df: pd.DataFrame
    Mask dataframe.
normalizer_y: str
    Normalizer for scaling Y_df.
normalizer_x: str
    Normalizer for scaling X_df.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>Y_df: pd.DataFrame
    Scaled target time series.
X_df: pd.DataFrame
    Scaled exogenous time series with columns.
scaler_y: Scaler
    Scaler object for Y_df.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>S_df</code></strong>:<code>DataFrame</code>, <strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>, <strong><code>f_cols</code></strong>:<code>list</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>, <strong><code>ds_in_val</code></strong>:<code>int</code>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Creates train, validation and test datasets.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.
S_df: pd.DataFrame
    Static exogenous variables with columns ['unique_id', 'ds']
    and static variables.
Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y']
f_cols: list
    List of exogenous variables of the future.
ds_in_test: int
    Number of ds in test.
ds_in_val: int
    Number of ds in validation.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>train_dataset: BaseDataset
    Train dataset.
valid_dataset: BaseDataset
    Validation dataset.
test_dataset: BaseDataset
    Test dataset.
scaler_y: Scaler
    Scaler object for Y_df.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L334" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>train_dataset</code></strong>:<a href="/neuralforecast/data__tsdataset.html#BaseDataset"><code>BaseDataset</code></a>, <strong><code>val_dataset</code></strong>:<a href="/neuralforecast/data__tsdataset.html#BaseDataset"><code>BaseDataset</code></a>, <strong><code>test_dataset</code></strong>:<a href="/neuralforecast/data__tsdataset.html#BaseDataset"><code>BaseDataset</code></a>)</p>
</blockquote>
<p>Creates train, validation and test loader classes.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.
train_dataset: BaseDataset
    Train dataset.
val_dataset: BaseDataset
    Validation dataset.
test_dataset: BaseDataset
    Test dataset.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>train_loader: DataLoader
    Train loader.
val_loader: DataLoader
    Validation loader.
test_loader: DataLoader
    Test loader.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L405" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates nbeats model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: NBEATS
    Nbeats model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L455" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates esrnn model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: ESRNN
    Esrnn model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_rnn" class="doc_header"><code>instantiate_rnn</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L504" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_rnn</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates esrnn model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: RNN
    RNN model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L549" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates mqesrnn model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: MQESRNN
    Mqesrnn model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nhits" class="doc_header"><code>instantiate_nhits</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L596" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nhits</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates nhits model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: NHITS
    Nhits model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_autoformer" class="doc_header"><code>instantiate_autoformer</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L651" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_autoformer</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates autoformer model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: Autoformer
    Autoformer model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L701" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Creates one of the models.
(nbeats, esrnn, mqesrnn, nhits, autoformer)</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: pl.LightningModule
    Forecast model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict" class="doc_header"><code>predict</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L725" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>model</code></strong>:<code>LightningModule</code>, <strong><code>trainer</code></strong>:<code>Trainer</code>, <strong><code>loader</code></strong>:<code>DataLoader</code>, <strong><code>scaler_y</code></strong>:<a href="/neuralforecast/data__scalers.html#Scaler"><code>Scaler</code></a>)</p>
</blockquote>
<p>Predicts results on dataset using trained model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.
model: pl.LightningModule
    Forecast model.
trainer: pl.Trainer
    Trainer object.
loader: DataLoader
    Data loader.
scaler_y: Scaler
    Scaler object for target time series.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>y_true: np.array
    True values from dataset.
y_hat: np.array
    Predicted values from dataset.
mask: np.array
    Masks for values.
meta_data: np.array
    Metada from dataset.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fit" class="doc_header"><code>fit</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L776" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fit</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>=<em><code>None</code></em>, <strong><code>S_df</code></strong>:<code>DataFrame</code>=<em><code>None</code></em>, <strong><code>ds_in_val</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>ds_in_test</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>f_cols</code></strong>:<code>list</code>=<em><code>[]</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Traines model on given dataset.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.
Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y'].
S_df: pd.DataFrame
    Static exogenous variables with columns ['unique_id', 'ds'].
    and static variables.
ds_in_val: int
    Number of ds in validation.
ds_in_test: int
    Number of ds in test.
f_cols: list
    List of exogenous variables of the future.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>model: pl.LightningModule
    Forecast model.
trainer: pl.Trainer
    Trainer object.
val_loader: DataLoader
    Validation loader.
test_loader: DataLoader
    Test loader.
scaler_y: Scaler
    Scaler object for target time series.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L862" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>S_df</code></strong>:<code>DataFrame</code>, <strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>, <strong><code>f_cols</code></strong>:<code>list</code>, <strong><code>ds_in_val</code></strong>:<code>int</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>, <strong><code>verbose</code></strong>:<code>bool</code>)</p>
</blockquote>
<p>Traines model on train dataset, then calculates predictions
on test dataset.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dict
    Model configuration.
Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y'].
f_cols: list
    List of exogenous variables of the future.
ds_in_val: int
    Number of ds in validation.
ds_in_test: int
    Number of ds in test.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>results: dict
    Dictionary with results of training and prediction on model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L914" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>:<code>dict</code>, <strong><code>loss_function_val</code></strong>:<code>callable</code>, <strong><code>loss_functions_test</code></strong>:<code>dict</code>, <strong><code>S_df</code></strong>:<code>DataFrame</code>, <strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>, <strong><code>f_cols</code></strong>:<code>list</code>, <strong><code>ds_in_val</code></strong>:<code>int</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>, <strong><code>return_forecasts</code></strong>:<code>bool</code>, <strong><code>return_model</code></strong>:<code>bool</code>, <strong><code>save_trials</code></strong>:<code>bool</code>, <strong><code>trials</code></strong>:<code>Trials</code>, <strong><code>results_dir</code></strong>:<code>str</code>, <strong><code>step_save_progress</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>loss_kwargs</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Evaluate model on given dataset.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>mc: dictionary
    Model configuration.
loss_function_val: function
    Loss function used for validation.
loss_functions_test: Dictionary
    Loss functions used for test.
    (function name: string, function: fun)
S_df: pd.DataFrame
    Static exogenous variables with columns ['unique_id', 'ds'].
    and static variables.
Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y'].
f_cols: list
    List of exogenous variables of the future.
ds_in_val: int
    Number of ds in validation.
ds_in_test: int
    Number of ds in test.
return_forecasts: bool
    If true return forecast on test.
save_trials: bool
    If true save progres in file.
trials: hyperopt.Trials
    Results from model evaluation.
results_dir: str
    File path to save results.
step_save_progress: int
    Every n-th step is saved in file.
loss_kwargs: List
    Loss function arguments.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>results_output: dict
    Dictionary with results of model evaluation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/experiments/utils.py#L1044" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>:<code>dict</code>, <strong><code>hyperopt_max_evals</code></strong>:<code>int</code>, <strong><code>loss_function_val</code></strong>:<code>callable</code>, <strong><code>loss_functions_test</code></strong>:<code>dict</code>, <strong><code>S_df</code></strong>:<code>DataFrame</code>, <strong><code>Y_df</code></strong>:<code>DataFrame</code>, <strong><code>X_df</code></strong>:<code>DataFrame</code>, <strong><code>f_cols</code></strong>:<code>list</code>, <strong><code>ds_in_val</code></strong>:<code>int</code>, <strong><code>ds_in_test</code></strong>:<code>int</code>, <strong><code>return_forecasts</code></strong>:<code>bool</code>, <strong><code>return_model</code></strong>:<code>bool</code>, <strong><code>save_trials</code></strong>:<code>bool</code>, <strong><code>results_dir</code></strong>:<code>str</code>, <strong><code>step_save_progress</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>loss_kwargs</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Evaluates multiple models trained on given dataset.
Models are trained with different hyperparameters.
Hyperparameters are changed until function is minimized in
hyperparameter space. All models are trained and evaluated,
until function is minimized.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>space: Dictionary
    Dictionary that contines hyperparameters that create space.
hyperopt_max_evals: int
    Maximum number of evaluations.
loss_function_val: function
    Loss function used for validation.
loss_functions_test: Dictionary
    Loss functions used for test.
    (function name: string, function: fun)
S_df: pd.DataFrame
    Static exogenous variables with columns ['unique_id', 'ds'].
    and static variables.
Y_df: pd.DataFrame
    Target time series with columns ['unique_id', 'ds', 'y'].
X_df: pd.DataFrame
    Exogenous time series with columns ['unique_id', 'ds', 'y'].
f_cols: list
    List of exogenous variables of the future.
ds_in_val: int
    Number of ds in validation.
ds_in_test: int
    Number of ds in test.
return_forecasts: bool
    If true return forecast on test.
return_model: bool
    If true return models.
save_trials: bool
    If true save progres in file.
results_dir: str
    File path to save results.
step_save_progress: int
    Every n-th step is saved in file.
loss_kwargs: List
    Loss function arguments.
verbose:
    If true, will print summary of dataset, model and training.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>trials: Trials
    Results from model evaluation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1><blockquote><p>This part of notebook shows simple use of functions given in this notebook. EPF dataset in used in this experiments. Two experiments are shown where hyperparameter tunning is runned for two models NHITS and NBEATS.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>

<span class="kn">from</span> <span class="nn">neuralforecast.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span>
<span class="kn">from</span> <span class="nn">neuralforecast.auto</span> <span class="kn">import</span> <span class="n">nhits_space</span><span class="p">,</span> <span class="n">nbeats_space</span>
<span class="kn">from</span> <span class="nn">neuralforecast.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>
<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Returning-model">Returning model<a class="anchor-link" href="#Returning-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">nhits_space</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="c1">#, n_series=1, n_x=1, n_s=0, frequency=&#39;H&#39;)</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Override max_steps for faster example</span>
<span class="c1"># The suggested spaces are partial, here we complete them with data specific information</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_series&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_x&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_x&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">X_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_s&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_s&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">S_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">S_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_x_hidden&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_x_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">X_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_s_hidden&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_s_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">S_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">S_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="c1"># Infers freq with first time series</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">Y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;ds&#39;</span><span class="p">])</span> 
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="n">freq</span> <span class="p">])</span>

<span class="n">model</span><span class="p">,</span> <span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function_val</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                                 <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">},</span>
                                 <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                                 <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> 
                                 <span class="n">return_forecasts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_trials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">results_dir</span><span class="o">=</span><span class="s1">&#39;./results/example&#39;</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Without-returning-model">Without returning model<a class="anchor-link" href="#Without-returning-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">nbeats_space</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;max_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;max_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Override max_steps for faster example</span>
 <span class="c1"># The suggested spaces are partial, here we complete them with data specific information</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_series&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_x&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_x&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">X_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_s&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_s&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">S_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">S_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_x_hidden&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_x_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">X_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;n_s_hidden&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_s_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">S_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">S_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="c1"># Infers freq with first time series</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">Y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;ds&#39;</span><span class="p">])</span> 
<span class="n">space</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="n">freq</span> <span class="p">])</span>
<span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function_val</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">loss_functions_test</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">},</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> 
                          <span class="n">return_forecasts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_trials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">results_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

