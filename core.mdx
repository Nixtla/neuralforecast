



# <kbd>module</kbd> `neuralforecast.core`




**Global Variables**
---------------
- **MODEL_FILENAME_DICT**


---



## <kbd>class</kbd> `NeuralForecast`






### <kbd>method</kbd> `__init__`

```python
__init__(
    models: List[Any],
    freq: Union[str, int],
    local_scaler_type: Optional[str] = None
)
```

The `core.StatsForecast` class allows you to efficiently fit multiple `NeuralForecast` models for large sets of time series. It operates with pandas DataFrame `df` that identifies series and datestamps with the `unique_id` and `ds` columns. The `y` column denotes the target time series variable. 



**Args:**
 
 - <b>`models`</b> (List[typing.Any]):  Instantiated `neuralforecast.models`  see [collection here](./models). 
 - <b>`freq`</b> (str or int):  Frequency of the data. Must be a valid pandas or polars offset alias, or an integer. 
 - <b>`local_scaler_type`</b> (str, optional):  Scaler to apply per-serie to all features before fitting, which is inverted after predicting.  Can be 'standard', 'robust', 'robust-iqr', 'minmax' or 'boxcox'. Defaults to None. 



**Returns:**
 
 - <b>`NeuralForecast`</b>:  Returns instantiated `NeuralForecast` class. 




---



### <kbd>method</kbd> `cross_validation`

```python
cross_validation(
    df: Optional[DataFrame, DataFrame] = None,
    static_df: Optional[DataFrame, DataFrame] = None,
    n_windows: int = 1,
    step_size: int = 1,
    val_size: Optional[int] = 0,
    test_size: Optional[int] = None,
    use_init_models: bool = False,
    verbose: bool = False,
    refit: Union[bool, int] = False,
    id_col: str = 'unique_id',
    time_col: str = 'ds',
    target_col: str = 'y',
    prediction_intervals: Optional[PredictionIntervals] = None,
    level: Optional[List[Union[int, float]]] = None,
    quantiles: Optional[List[float]] = None,
    **data_kwargs
) → Union[DataFrame, DataFrame]
```

Temporal Cross-Validation with core.NeuralForecast. 

`core.NeuralForecast`'s cross-validation efficiently fits a list of NeuralForecast models through multiple windows, in either chained or rolled manner. 



**Args:**
 
 - <b>`df`</b> (pandas or polars DataFrame, optional):  DataFrame with columns [`unique_id`, `ds`, `y`] and exogenous variables.  If None, a previously stored dataset is required. Defaults to None. 
 - <b>`static_df`</b> (pandas or polars DataFrame, optional):  DataFrame with columns [`unique_id`] and static exogenous. Defaults to None. 
 - <b>`n_windows`</b> (int):  Number of windows used for cross validation. Defaults to 1. 
 - <b>`step_size`</b> (int):  Step size between each window. Defaults to 1. 
 - <b>`val_size`</b> (int, optional):  Length of validation size. If passed, set `n_windows=None`. Defaults to 0. 
 - <b>`test_size`</b> (int, optional):  Length of test size. If passed, set `n_windows=None`. Defaults to None. 
 - <b>`use_init_models`</b> (bool, optional):  Use initial model passed when object was instantiated. Defaults to False. 
 - <b>`verbose`</b> (bool):  Print processing steps. Defaults to False. 
 - <b>`refit`</b> (bool or int):  Retrain model for each cross validation window.  If False, the models are trained at the beginning and then used to predict each window.  If positive int, the models are retrained every `refit` windows. Defaults to False. 
 - <b>`id_col`</b> (str):  Column that identifies each serie. Defaults to 'unique_id'. 
 - <b>`time_col`</b> (str):  Column that identifies each timestep, its values can be timestamps or integers. Defaults to 'ds'. 
 - <b>`target_col`</b> (str):  Column that contains the target. Defaults to 'y'. 
 - <b>`prediction_intervals`</b> (PredictionIntervals, optional):  Configuration to calibrate prediction intervals (Conformal Prediction). Defaults to None. 
 - <b>`level`</b> (list of ints or floats, optional):  Confidence levels between 0 and 100. Defaults to None. 
 - <b>`quantiles`</b> (list of floats, optional):  Alternative to level, target quantiles to predict. Defaults to None. 
 - <b>`data_kwargs`</b> (kwargs):  Extra arguments to be passed to the dataset within each model. 



**Returns:**
 
 - <b>`fcsts_df`</b> (pandas or polars DataFrame):  DataFrame with insample `models` columns for point predictions and probabilistic  predictions for all fitted `models`. 

---



### <kbd>method</kbd> `fit`

```python
fit(
    df: Optional[DataFrame, DataFrame, DataFrame, Sequence[str]] = None,
    static_df: Optional[DataFrame, DataFrame, DataFrame] = None,
    val_size: Optional[int] = 0,
    use_init_models: bool = False,
    verbose: bool = False,
    id_col: str = 'unique_id',
    time_col: str = 'ds',
    target_col: str = 'y',
    distributed_config: Optional[DistributedConfig] = None,
    prediction_intervals: Optional[PredictionIntervals] = None
) → None
```

Fit the core.NeuralForecast. 

Fit `models` to a large set of time series from DataFrame `df`. and store fitted models for later inspection. 



**Args:**
 
 - <b>`df`</b> (pandas, polars or spark DataFrame, or a list of parquet files containing the series, optional):  DataFrame with columns [`unique_id`, `ds`, `y`] and exogenous variables.  If None, a previously stored dataset is required. Defaults to None. 
 - <b>`static_df`</b> (pandas, polars or spark DataFrame, optional):  DataFrame with columns [`unique_id`] and static exogenous. Defaults to None. 
 - <b>`val_size`</b> (int, optional):  Size of validation set. Defaults to 0. 
 - <b>`use_init_models`</b> (bool, optional):  Use initial model passed when NeuralForecast object was instantiated. Defaults to False. 
 - <b>`verbose`</b> (bool):  Print processing steps. Defaults to False. 
 - <b>`id_col`</b> (str):  Column that identifies each serie. Defaults to 'unique_id'. 
 - <b>`time_col`</b> (str):  Column that identifies each timestep, its values can be timestamps or integers. Defaults to 'ds'. 
 - <b>`target_col`</b> (str):  Column that contains the target. Defaults to 'y'. 
 - <b>`distributed_config`</b> (neuralforecast.DistributedConfig):  Configuration to use for DDP training. Currently only spark is supported. 
 - <b>`prediction_intervals`</b> (PredictionIntervals, optional):  Configuration to calibrate prediction intervals (Conformal Prediction). Defaults to None. 



**Returns:**
 
 - <b>`NeuralForecast`</b>:  Returns `NeuralForecast` class with fitted `models`. 

---



### <kbd>method</kbd> `get_missing_future`

```python
get_missing_future(futr_df: ~DFType, df: Optional[~DFType] = None) → ~DFType
```

Get the missing ids and times combinations in `futr_df`. 



**Args:**
 
 - <b>`futr_df`</b> (pandas or polars DataFrame):  DataFrame with [`unique_id`, `ds`] columns and `df`'s future exogenous. 
 - <b>`df`</b> (pandas or polars DataFrame, optional):  DataFrame with columns [`unique_id`, `ds`, `y`] and exogenous variables.  Only required if this is different than the one used in the fit step. Defaults to None. 

---



### <kbd>method</kbd> `load`

```python
load(path, verbose=False, **kwargs)
```

Load NeuralForecast 

`core.NeuralForecast`'s method to load checkpoint from path. 



**Args:**
 
 - <b>`path`</b> (str):  Directory with stored artifacts. 
 - <b>`verbose`</b> (bool):  Defaults to False. 
 - <b>`**kwargs`</b>:  Additional keyword arguments to be passed to the function  `load_from_checkpoint`. 



**Returns:**
 
 - <b>`result`</b> (NeuralForecast):  Instantiated `NeuralForecast` class. 

---



### <kbd>method</kbd> `make_future_dataframe`

```python
make_future_dataframe(df: Optional[~DFType] = None) → ~DFType
```

Create a dataframe with all ids and future times in the forecasting horizon. 



**Args:**
 
 - <b>`df`</b> (pandas or polars DataFrame, optional):  DataFrame with columns [`unique_id`, `ds`, `y`] and exogenous variables.  Only required if this is different than the one used in the fit step. Defaults to None. 

---



### <kbd>method</kbd> `predict`

```python
predict(
    df: Optional[DataFrame, DataFrame, DataFrame] = None,
    static_df: Optional[DataFrame, DataFrame, DataFrame] = None,
    futr_df: Optional[DataFrame, DataFrame, DataFrame] = None,
    verbose: bool = False,
    engine=None,
    level: Optional[List[Union[int, float]]] = None,
    quantiles: Optional[List[float]] = None,
    **data_kwargs
)
```

Predict with core.NeuralForecast. 

Use stored fitted `models` to predict large set of time series from DataFrame `df`. 



**Args:**
 
 - <b>`df`</b> (pandas, polars or spark DataFrame, optional):  DataFrame with columns [`unique_id`, `ds`, `y`] and exogenous variables.  If a DataFrame is passed, it is used to generate forecasts. Defaults to None. 
 - <b>`static_df`</b> (pandas, polars or spark DataFrame, optional):  DataFrame with columns [`unique_id`] and static exogenous. Defaults to None. 
 - <b>`futr_df`</b> (pandas, polars or spark DataFrame, optional):  DataFrame with [`unique_id`, `ds`] columns and `df`'s future exogenous. Defaults to None. 
 - <b>`verbose`</b> (bool):  Print processing steps. Defaults to False. 
 - <b>`engine`</b> (spark session):  Distributed engine for inference. Only used if df is a spark dataframe or if fit was called on a spark dataframe. 
 - <b>`level`</b> (list of ints or floats, optional):  Confidence levels between 0 and 100. Defaults to None. 
 - <b>`quantiles`</b> (list of floats, optional):  Alternative to level, target quantiles to predict. Defaults to None. 
 - <b>`data_kwargs`</b> (kwargs):  Extra arguments to be passed to the dataset within each model. 



**Returns:**
 
 - <b>`fcsts_df`</b> (pandas or polars DataFrame):  DataFrame with insample `models` columns for point predictions and probabilistic  predictions for all fitted `models`. 

---



### <kbd>method</kbd> `predict_insample`

```python
predict_insample(
    step_size: int = 1,
    level: Optional[List[Union[int, float]]] = None,
    quantiles: Optional[List[float]] = None
)
```

Predict insample with core.NeuralForecast. 

`core.NeuralForecast`'s `predict_insample` uses stored fitted `models` to predict historic values of a time series from the stored dataframe. 



**Args:**
 
 - <b>`step_size`</b> (int):  Step size between each window. Defaults to 1. 
 - <b>`level`</b> (list of ints or floats, optional):  Confidence levels between 0 and 100. Defaults to None. 
 - <b>`quantiles`</b> (list of floats, optional):  Alternative to level, target quantiles to predict. Defaults to None. 



**Returns:**
 
 - <b>`fcsts_df`</b> (pandas.DataFrame):  DataFrame with insample predictions for all fitted `models`. 

---



### <kbd>method</kbd> `save`

```python
save(
    path: str,
    model_index: Optional[List] = None,
    save_dataset: bool = True,
    overwrite: bool = False
)
```

Save NeuralForecast core class. 

`core.NeuralForecast`'s method to save current status of models, dataset, and configuration. Note that by default the `models` are not saving training checkpoints to save disk memory, to get them change the individual model `**trainer_kwargs` to include `enable_checkpointing=True`. 



**Args:**
 
 - <b>`path`</b> (str):  Directory to save current status. 
 - <b>`model_index`</b> (list, optional):  List to specify which models from list of self.models to save. Defaults to None. 
 - <b>`save_dataset`</b> (bool):  Whether to save dataset or not. Defaults to True. 
 - <b>`overwrite`</b> (bool):  Whether to overwrite files or not. Defaults to False. 


